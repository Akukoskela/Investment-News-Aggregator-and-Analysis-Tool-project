"use strict";(self.webpackChunkInvestment_News_Aggregator_and_Analysis_Tool_project=self.webpackChunkInvestment_News_Aggregator_and_Analysis_Tool_project||[]).push([[982],{6425:(fe,q,E)=>{E.d(q,{T:()=>ti});var d=E(5861);class P extends Error{constructor(n,e="FunctionsError",t){super(n),this.name=e,this.context=t}}class J extends P{constructor(n){super("Failed to send a request to the Edge Function","FunctionsFetchError",n)}}class N extends P{constructor(n){super("Relay Error invoking the Edge Function","FunctionsRelayError",n)}}class D extends P{constructor(n){super("Edge Function returned a non-2xx status code","FunctionsHttpError",n)}}class F{constructor(n,{headers:e={},customFetch:t}={}){this.url=n,this.headers=e,this.fetch=(o=>{let n;return n=o||(typeof fetch>"u"?(...e)=>Promise.resolve().then(E.bind(E,6397)).then(({default:t})=>t(...e)):fetch),(...e)=>n(...e)})(t)}setAuth(n){this.headers.Authorization=`Bearer ${n}`}invoke(n,e={}){var t;return function(o,n,e,t){return new(e||(e=Promise))(function(r,s){function a(h){try{u(t.next(h))}catch(v){s(v)}}function c(h){try{u(t.throw(h))}catch(v){s(v)}}function u(h){h.done?r(h.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(h.value).then(a,c)}u((t=t.apply(o,n||[])).next())})}(this,void 0,void 0,function*(){try{const{headers:i,method:r,body:s}=e;let c,a={};s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=s):"string"==typeof s?(a["Content-Type"]="text/plain",c=s):typeof FormData<"u"&&s instanceof FormData?c=s:(a["Content-Type"]="application/json",c=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${n}`,{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:c}).catch(x=>{throw new J(x)}),h=u.headers.get("x-relay-error");if(h&&"true"===h)throw new N(u);if(!u.ok)throw new D(u);let M,v=(null!==(t=u.headers.get("Content-Type"))&&void 0!==t?t:"text/plain").split(";")[0].trim();return M="application/json"===v?yield u.json():"application/octet-stream"===v?yield u.blob():"multipart/form-data"===v?yield u.formData():yield u.text(),{data:M,error:null}}catch(i){return{data:null,error:i}}})}}var w=E(6397);class j extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}class B{constructor(n){this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=n.headers,this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=n.shouldThrowOnError,this.signal=n.signal,this.isMaybeSingle=n.isMaybeSingle,this.fetch=n.fetch?n.fetch:typeof fetch>"u"?w.default:fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(n,e){var t=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(function(){var s=(0,d.Z)(function*(a){var c,u,h;let v=null,M=null,x=null,S=a.status,U=a.statusText;if(a.ok){if("HEAD"!==t.method){const he=yield a.text();""===he||(M="text/csv"===t.headers.Accept||t.headers.Accept&&t.headers.Accept.includes("application/vnd.pgrst.plan+text")?he:JSON.parse(he))}const ne=null===(c=t.headers.Prefer)||void 0===c?void 0:c.match(/count=(exact|planned|estimated)/),ue=null===(u=a.headers.get("content-range"))||void 0===u?void 0:u.split("/");ne&&ue&&ue.length>1&&(x=parseInt(ue[1])),t.isMaybeSingle&&"GET"===t.method&&Array.isArray(M)&&(M.length>1?(v={code:"PGRST116",details:`Results contain ${M.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},M=null,x=null,S=406,U="Not Acceptable"):M=1===M.length?M[0]:null)}else{const ne=yield a.text();try{v=JSON.parse(ne),Array.isArray(v)&&404===a.status&&(M=[],v=null,S=200,U="OK")}catch{404===a.status&&""===ne?(S=204,U="No Content"):v={message:ne}}if(v&&t.isMaybeSingle&&!(null===(h=v?.details)||void 0===h)&&h.includes("0 rows")&&(v=null,S=200,U="OK"),v&&t.shouldThrowOnError)throw new j(v)}return{error:v,data:M,count:x,status:S,statusText:U}});return function(a){return s.apply(this,arguments)}}());return this.shouldThrowOnError||(r=r.catch(s=>{var a,c,u;return{error:{message:`${null!==(a=s?.name)&&void 0!==a?a:"FetchError"}: ${s?.message}`,details:`${null!==(c=s?.stack)&&void 0!==c?c:""}`,hint:"",code:`${null!==(u=s?.code)&&void 0!==u?u:""}`},data:null,count:null,status:0,statusText:""}})),r.then(n,e)}}class R extends B{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":('"'===i&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:r=i}={}){const s=r?`${r}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${n}.${e?"asc":"desc"}${void 0===t?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){return this.url.searchParams.set(typeof t>"u"?"limit":`${t}.limit`,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(typeof i>"u"?"offset":`${i}.offset`,`${n}`),this.url.searchParams.set(s,""+(e-n+1)),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="GET"===this.method?"application/json":"application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:r=!1,format:s="text"}={}){var a;const c=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,r?"wal":null].filter(Boolean).join("|"),u=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${u}"; options=${c};`,this}rollback(){var n;return(null!==(n=this.headers.Prefer)&&void 0!==n?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class G extends R{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}in(n,e){const t=e.map(i=>"string"==typeof i&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}contains(n,e){return"string"==typeof e?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return"string"==typeof e?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return this.url.searchParams.append(n,"string"==typeof e?`ov.${e}`:`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let r="";return"plain"===i?r="pl":"phrase"===i?r="ph":"websearch"===i&&(r="w"),this.url.searchParams.append(n,`${r}fts${void 0===t?"":`(${t})`}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){return this.url.searchParams.append(t?`${t}.or`:"or",`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}}class H{constructor(n,{headers:e={},schema:t,fetch:i}){this.url=n,this.headers=e,this.schema=t,this.fetch=i}select(n,{head:e=!1,count:t}={}){const i=e?"HEAD":"GET";let r=!1;const s=(n??"*").split("").map(a=>/\s/.test(a)&&!r?"":('"'===a&&(r=!r),a)).join("");return this.url.searchParams.set("select",s),t&&(this.headers.Prefer=`count=${t}`),new G({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:e,defaultToNull:t=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),e&&r.push(`count=${e}`),t||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(n)){const s=n.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(s.length>0){const a=[...new Set(s)].map(c=>`"${c}"`);this.url.searchParams.set("columns",a.join(","))}}return new G({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:r=!0}={}){const a=[`resolution=${t?"ignore":"merge"}-duplicates`];if(void 0!==e&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new G({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:e}={}){const i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),e&&i.push(`count=${e}`),this.headers.Prefer=i.join(","),new G({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const t=[];return n&&t.push(`count=${n}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new G({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const ie={"X-Client-Info":"postgrest-js/1.9.2"};class se{constructor(n,{headers:e={},schema:t,fetch:i}={}){this.url=n,this.headers=Object.assign(Object.assign({},ie),e),this.schemaName=t,this.fetch=i}from(n){const e=new URL(`${this.url}/${n}`);return new H(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(n){return new se(this.url,{headers:this.headers,schema:n,fetch:this.fetch})}rpc(n,e={},{head:t=!1,count:i}={}){let r;const s=new URL(`${this.url}/rpc/${n}`);let a;t?(r="HEAD",Object.entries(e).forEach(([u,h])=>{s.searchParams.append(u,`${h}`)})):(r="POST",a=e);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new G({method:r,url:s,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const Ee={"X-Client-Info":"realtime-js/2.9.3"};var Y=(()=>{return(o=Y||(Y={}))[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed",Y;var o})(),te=(()=>{return(o=te||(te={})).closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving",te;var o})(),oe=(()=>{return(o=oe||(oe={})).close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token",oe;var o})(),Ne=(()=>((Ne||(Ne={})).websocket="websocket",Ne))(),ge=(()=>{return(o=ge||(ge={})).Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed",ge;var o})();class yt{constructor(n,e){this.callback=n,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=n,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Wt{constructor(){this.HEADER_LENGTH=1}decode(n,e){return n.constructor===ArrayBuffer?e(this._binaryDecode(n)):e("string"==typeof n?JSON.parse(n):{})}_binaryDecode(n){const e=new DataView(n),t=new TextDecoder;return this._decodeBroadcast(n,e,t)}_decodeBroadcast(n,e,t){const i=e.getUint8(1),r=e.getUint8(2);let s=this.HEADER_LENGTH+2;const a=t.decode(n.slice(s,s+i));s+=i;const c=t.decode(n.slice(s,s+r));return s+=r,{ref:null,topic:a,event:c,payload:JSON.parse(t.decode(n.slice(s,n.byteLength)))}}}class Xe{constructor(n,e,t={},i=1e4){this.channel=n,this.event=e,this.payload=t,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(n){this.timeout=n,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(n){this.payload=Object.assign(Object.assign({},this.payload),n)}receive(n,e){var t;return this._hasReceived(n)&&e(null===(t=this.receivedResp)||void 0===t?void 0:t.response),this.recHooks.push({status:n,callback:e}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(n,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:n,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:n,response:e}){this.recHooks.filter(t=>t.status===n).forEach(t=>t.callback(e))}_hasReceived(n){return this.receivedResp&&this.receivedResp.status===n}}class ke{constructor(n,e){this.channel=n,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},i=>{const{onJoin:r,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ke.syncState(this.state,i,r,s),this.pendingDiffs.forEach(c=>{this.state=ke.syncDiff(this.state,c,r,s)}),this.pendingDiffs=[],a()}),this.channel._on(t.diff,{},i=>{const{onJoin:r,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ke.syncDiff(this.state,i,r,s),a())}),this.onJoin((i,r,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:r,newPresences:s})}),this.onLeave((i,r,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:r,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(n,e,t,i){const r=this.cloneDeep(n),s=this.transformState(e),a={},c={};return this.map(r,(u,h)=>{s[u]||(c[u]=h)}),this.map(s,(u,h)=>{const v=r[u];if(v){const M=h.map(z=>z.presence_ref),x=v.map(z=>z.presence_ref),S=h.filter(z=>x.indexOf(z.presence_ref)<0),U=v.filter(z=>M.indexOf(z.presence_ref)<0);S.length>0&&(a[u]=S),U.length>0&&(c[u]=U)}else a[u]=h}),this.syncDiff(r,{joins:a,leaves:c},t,i)}static syncDiff(n,e,t,i){const{joins:r,leaves:s}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return t||(t=()=>{}),i||(i=()=>{}),this.map(r,(a,c)=>{var u;const h=null!==(u=n[a])&&void 0!==u?u:[];if(n[a]=this.cloneDeep(c),h.length>0){const v=n[a].map(x=>x.presence_ref),M=h.filter(x=>v.indexOf(x.presence_ref)<0);n[a].unshift(...M)}t(a,h,c)}),this.map(s,(a,c)=>{let u=n[a];if(!u)return;const h=c.map(v=>v.presence_ref);u=u.filter(v=>h.indexOf(v.presence_ref)<0),n[a]=u,i(a,u,c),0===u.length&&delete n[a]}),n}static map(n,e){return Object.getOwnPropertyNames(n).map(t=>e(t,n[t]))}static transformState(n){return n=this.cloneDeep(n),Object.getOwnPropertyNames(n).reduce((e,t)=>{const i=n[t];return e[t]="metas"in i?i.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):i,e},{})}static cloneDeep(n){return JSON.parse(JSON.stringify(n))}onJoin(n){this.caller.onJoin=n}onLeave(n){this.caller.onLeave=n}onSync(n){this.caller.onSync=n}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Q=(()=>{return(o=Q||(Q={})).abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange",Q;var o})();const bt=(o,n,e={})=>{var t;const i=null!==(t=e.skipTypes)&&void 0!==t?t:[];return Object.keys(n).reduce((r,s)=>(r[s]=zt(s,o,n,i),r),{})},zt=(o,n,e,t)=>{const r=n.find(a=>a.name===o)?.type,s=e[o];return r&&!t.includes(r)?Et(r,s):Qe(s)},Et=(o,n)=>{if("_"===o.charAt(0)){const e=o.slice(1,o.length);return Xt(n,e)}switch(o){case Q.bool:return Yt(n);case Q.float4:case Q.float8:case Q.int2:case Q.int4:case Q.int8:case Q.numeric:case Q.oid:return Jt(n);case Q.json:case Q.jsonb:return qt(n);case Q.timestamp:return Qt(n);default:return Qe(n)}},Qe=o=>o,Yt=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Jt=o=>{if("string"==typeof o){const n=parseFloat(o);if(!Number.isNaN(n))return n}return o},qt=o=>{if("string"==typeof o)try{return JSON.parse(o)}catch(n){return console.log(`JSON parse error: ${n}`),o}return o},Xt=(o,n)=>{if("string"!=typeof o)return o;const e=o.length-1;if("{"===o[0]&&"}"===o[e]){let r;const s=o.slice(1,e);try{r=JSON.parse("["+s+"]")}catch{r=s?s.split(","):[]}return r.map(a=>Et(n,a))}return o},Qt=o=>"string"==typeof o?o.replace(" ","T"):o;class Ve{constructor(n,e={config:{}},t){this.topic=n,this.params=e,this.socket=t,this.bindings={},this.state=te.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=n.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},e.config),this.timeout=this.socket.timeout,this.joinPush=new Xe(this,oe.join,this.params,this.timeout),this.rejoinTimer=new yt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=te.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=te.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=te.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=te.errored,this.rejoinTimer.scheduleTimeout())}),this._on(oe.reply,{},(i,r)=>{this._trigger(this._replyEventName(r),i)}),this.presence=new ke(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(n,e=this.timeout){var t,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:r,presence:s}}=this.params;this._onError(u=>n&&n("CHANNEL_ERROR",u)),this._onClose(()=>n&&n("CLOSED"));const a={},c={broadcast:r,presence:s,postgres_changes:null!==(i=null===(t=this.bindings.postgres_changes)||void 0===t?void 0:t.map(u=>u.filter))&&void 0!==i?i:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:c},a)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",({postgres_changes:u})=>{var h;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0!==u){const v=this.bindings.postgres_changes,M=null!==(h=v?.length)&&void 0!==h?h:0,x=[];for(let S=0;S<M;S++){const U=v[S],{filter:{event:z,schema:ne,table:ue,filter:he}}=U,ce=u&&u[S];if(!ce||ce.event!==z||ce.schema!==ne||ce.table!==ue||ce.filter!==he)return this.unsubscribe(),void(n&&n("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes")));x.push(Object.assign(Object.assign({},U),{id:ce.id}))}return this.bindings.postgres_changes=x,void(n&&n("SUBSCRIBED"))}n&&n("SUBSCRIBED")}).receive("error",u=>{n&&n("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{n&&n("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(n,e={}){var t=this;return(0,d.Z)(function*(){return yield t.send({type:"presence",event:"track",payload:n},e.timeout||t.timeout)})()}untrack(n={}){var e=this;return(0,d.Z)(function*(){return yield e.send({type:"presence",event:"untrack"},n)})()}on(n,e,t){return this._on(n,e,t)}send(n,e={}){var t=this;return(0,d.Z)(function*(){var i,r;if(t._canPush()||"broadcast"!==n.type)return new Promise(s=>{var a,c,u;const h=t._push(n.type,n,e.timeout||t.timeout);"broadcast"===n.type&&!(null!==(u=null===(c=null===(a=t.params)||void 0===a?void 0:a.config)||void 0===c?void 0:c.broadcast)&&void 0!==u&&u.ack)&&s("ok"),h.receive("ok",()=>s("ok")),h.receive("timeout",()=>s("timed out"))});{const{event:s,payload:a}=n,c={method:"POST",headers:{apikey:null!==(i=t.socket.apiKey)&&void 0!==i?i:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:t.subTopic,event:s,payload:a}]})};try{return(yield t._fetchWithTimeout(t.broadcastEndpointURL,c,null!==(r=e.timeout)&&void 0!==r?r:t.timeout)).ok?"ok":"error"}catch(u){return"AbortError"===u.name?"timed out":"error"}}})()}updateJoinPayload(n){this.joinPush.updatePayload(n)}unsubscribe(n=this.timeout){this.state=te.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(oe.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const i=new Xe(this,oe.leave,{},n);i.receive("ok",()=>{e(),t("ok")}).receive("timeout",()=>{e(),t("timed out")}).receive("error",()=>{t("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_broadcastEndpointURL(){let n=this.socket.endPoint;return n=n.replace(/^ws/i,"http"),n=n.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),n.replace(/\/+$/,"")+"/api/broadcast"}_fetchWithTimeout(n,e,t){var i=this;return(0,d.Z)(function*(){const r=new AbortController,s=setTimeout(()=>r.abort(),t),a=yield i.socket.fetch(n,Object.assign(Object.assign({},e),{signal:r.signal}));return clearTimeout(s),a})()}_push(n,e,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${n}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Xe(this,n,e,t);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(n,e,t){return e}_isMember(n){return this.topic===n}_joinRef(){return this.joinPush.ref}_trigger(n,e,t){var i,r;const s=n.toLocaleLowerCase(),{close:a,error:c,leave:u,join:h}=oe;if(t&&[a,c,u,h].indexOf(s)>=0&&t!==this._joinRef())return;let M=this._onMessage(s,e,t);if(e&&!M)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(i=this.bindings.postgres_changes)||void 0===i||i.filter(x=>{var S,U,z;return"*"===(null===(S=x.filter)||void 0===S?void 0:S.event)||(null===(z=null===(U=x.filter)||void 0===U?void 0:U.event)||void 0===z?void 0:z.toLocaleLowerCase())===s}).map(x=>x.callback(M,t)):null===(r=this.bindings[s])||void 0===r||r.filter(x=>{var S,U,z,ne,ue,he;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in x){const ce=x.id,me=null===(S=x.filter)||void 0===S?void 0:S.event;return ce&&(null===(U=e.ids)||void 0===U?void 0:U.includes(ce))&&("*"===me||me?.toLocaleLowerCase()===(null===(z=e.data)||void 0===z?void 0:z.type.toLocaleLowerCase()))}{const ce=null===(ue=null===(ne=x?.filter)||void 0===ne?void 0:ne.event)||void 0===ue?void 0:ue.toLocaleLowerCase();return"*"===ce||ce===(null===(he=e?.event)||void 0===he?void 0:he.toLocaleLowerCase())}}return x.type.toLocaleLowerCase()===s}).map(x=>{if("object"==typeof M&&"ids"in M){const S=M.data,{schema:U,table:z,commit_timestamp:ne,type:ue,errors:he}=S;M=Object.assign(Object.assign({},{schema:U,table:z,commit_timestamp:ne,eventType:ue,new:{},old:{},errors:he}),this._getPayloadRecords(S))}x.callback(M,t)})}_isClosed(){return this.state===te.closed}_isJoined(){return this.state===te.joined}_isJoining(){return this.state===te.joining}_isLeaving(){return this.state===te.leaving}_replyEventName(n){return`chan_reply_${n}`}_on(n,e,t){const i=n.toLocaleLowerCase(),r={type:i,filter:e,callback:t};return this.bindings[i]?this.bindings[i].push(r):this.bindings[i]=[r],this}_off(n,e){const t=n.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(i=>{var r;return!((null===(r=i.type)||void 0===r?void 0:r.toLocaleLowerCase())===t&&Ve.isEqual(i.filter,e))}),this}static isEqual(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(n){this._on(oe.close,{},n)}_onError(n){this._on(oe.error,{},e=>n(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(n=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=te.joining,this.joinPush.resend(n))}_getPayloadRecords(n){const e={new:{},old:{}};return("INSERT"===n.type||"UPDATE"===n.type)&&(e.new=bt(n.columns,n.record)),("UPDATE"===n.type||"DELETE"===n.type)&&(e.old=bt(n.columns,n.old_record)),e}}const et=()=>{},Tt=typeof WebSocket<"u";class tt{constructor(n,e){var i,t=this;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=Ee,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=et,this.conn=null,this.sendBuffer=[],this.serializer=new Wt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let a;return a=s||(typeof fetch>"u"?(...c)=>Promise.resolve().then(E.bind(E,6397)).then(({default:u})=>u(...c)):fetch),(...c)=>a(...c)},this.endPoint=`${n}/${Ne.websocket}`,this.transport=e?.transport?e.transport:null,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const r=null===(i=e?.params)||void 0===i?void 0:i.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e?.encode?e.encode:(s,a)=>a(JSON.stringify(s)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new yt((0,d.Z)(function*(){t.disconnect(),t.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!this.conn){if(this.transport)return void(this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers}));if(Tt)return this.conn=new WebSocket(this._endPointURL()),void this.setupConnection();this.conn=new wt(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),E.e(144).then(E.t.bind(E,3144,23)).then(({default:n})=>{this.conn=new n(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(n,e){this.conn&&(this.conn.onclose=function(){},n?this.conn.close(n,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(n){var e=this;return(0,d.Z)(function*(){const t=yield n.unsubscribe();return 0===e.channels.length&&e.disconnect(),t})()}removeAllChannels(){var n=this;return(0,d.Z)(function*(){const e=yield Promise.all(n.channels.map(t=>t.unsubscribe()));return n.disconnect(),e})()}log(n,e,t){this.logger(n,e,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Y.connecting:return ge.Connecting;case Y.open:return ge.Open;case Y.closing:return ge.Closing;default:return ge.Closed}}isConnected(){return this.connectionState()===ge.Open}channel(n,e={config:{}}){const t=new Ve(`realtime:${n}`,e,this);return this.channels.push(t),t}push(n){const{topic:e,event:t,payload:i,ref:r}=n,s=()=>{this.encode(n,a=>{var c;null===(c=this.conn)||void 0===c||c.send(a)})};this.log("push",`${e} ${t} (${r})`,i),this.isConnected()?s():this.sendBuffer.push(s)}setAuth(n){this.accessToken=n,this.channels.forEach(e=>{n&&e.updateJoinPayload({access_token:n}),e.joinedOnce&&e._isJoined()&&e._push(oe.access_token,{access_token:n})})}_makeRef(){let n=this.ref+1;return this.ref=n===this.ref?0:n,this.ref.toString()}_leaveOpenTopic(n){let e=this.channels.find(t=>t.topic===n&&(t._isJoined()||t._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${n}"`),e.unsubscribe())}_remove(n){this.channels=this.channels.filter(e=>e._joinRef()!==n._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this._onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(n){this.decode(n.data,e=>{let{topic:t,event:i,payload:r,ref:s}=e;(s&&s===this.pendingHeartbeatRef||i===r?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${i} ${s&&"("+s+")"||""}`,r),this.channels.filter(a=>a._isMember(t)).forEach(a=>a._trigger(i,r,s)),this.stateChangeCallbacks.message.forEach(a=>a(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(n=>n())}_onConnClose(n){this.log("transport","close",n),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(n))}_onConnError(n){this.log("transport",n.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(n))}_triggerChanError(){this.channels.forEach(n=>n._trigger(oe.error))}_appendParams(n,e){if(0===Object.keys(e).length)return n;const t=n.match(/\?/)?"&":"?";return`${n}${t}${new URLSearchParams(e)}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(n=>n()),this.sendBuffer=[])}_sendHeartbeat(){var n;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(n=this.conn)||void 0===n||n.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class wt{constructor(n,e,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Y.connecting,this.send=()=>{},this.url=null,this.url=n,this.close=t.close}}class je extends Error{constructor(n){super(n),this.__isStorageError=!0,this.name="StorageError"}}function re(o){return"object"==typeof o&&null!==o&&"__isStorageError"in o}class nt extends je{constructor(n,e){super(n),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Te extends je{constructor(n,e){super(n),this.name="StorageUnknownError",this.originalError=e}}const it=o=>{let n;return n=o||(typeof fetch>"u"?(...e)=>Promise.resolve().then(E.bind(E,6397)).then(({default:t})=>t(...e)):fetch),(...e)=>n(...e)};var we=function(o,n,e,t){return new(e||(e=Promise))(function(r,s){function a(h){try{u(t.next(h))}catch(v){s(v)}}function c(h){try{u(t.throw(h))}catch(v){s(v)}}function u(h){h.done?r(h.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(h.value).then(a,c)}u((t=t.apply(o,n||[])).next())})};const rt=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),en=(o,n)=>we(void 0,void 0,void 0,function*(){const e=yield function(o,n,e,t){return new(e||(e=Promise))(function(r,s){function a(h){try{u(t.next(h))}catch(v){s(v)}}function c(h){try{u(t.throw(h))}catch(v){s(v)}}function u(h){h.done?r(h.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(h.value).then(a,c)}u((t=t.apply(o,n||[])).next())})}(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Promise.resolve().then(E.bind(E,6397))).Response:Response});o instanceof e?o.json().then(t=>{n(new nt(rt(t),o.status||500))}).catch(t=>{n(new Te(rt(t),t))}):n(new Te(rt(o),o))}),tn=(o,n,e,t)=>{const i={method:o,headers:n?.headers||{}};return"GET"===o?i:(i.headers=Object.assign({"Content-Type":"application/json"},n?.headers),i.body=JSON.stringify(t),Object.assign(Object.assign({},i),e))};function Ge(o,n,e,t,i,r){return we(this,void 0,void 0,function*(){return new Promise((s,a)=>{o(e,tn(n,t,i,r)).then(c=>{if(!c.ok)throw c;return t?.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>en(c,a))})})}function st(o,n,e,t){return we(this,void 0,void 0,function*(){return Ge(o,"GET",n,e,t)})}function ye(o,n,e,t,i){return we(this,void 0,void 0,function*(){return Ge(o,"POST",n,t,i,e)})}function nn(o,n,e,t,i){return we(this,void 0,void 0,function*(){return Ge(o,"PUT",n,t,i,e)})}function It(o,n,e,t,i){return we(this,void 0,void 0,function*(){return Ge(o,"DELETE",n,t,i,e)})}var _e=function(o,n,e,t){return new(e||(e=Promise))(function(r,s){function a(h){try{u(t.next(h))}catch(v){s(v)}}function c(h){try{u(t.throw(h))}catch(v){s(v)}}function u(h){h.done?r(h.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(h.value).then(a,c)}u((t=t.apply(o,n||[])).next())})};const rn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},St={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class kt{constructor(n,e={},t,i){this.url=n,this.headers=e,this.bucketId=t,this.fetch=it(i)}uploadOrUpdate(n,e,t,i){return _e(this,void 0,void 0,function*(){try{let r;const s=Object.assign(Object.assign({},St),i),a=Object.assign(Object.assign({},this.headers),"POST"===n&&{"x-upsert":String(s.upsert)});typeof Blob<"u"&&t instanceof Blob?(r=new FormData,r.append("cacheControl",s.cacheControl),r.append("",t)):typeof FormData<"u"&&t instanceof FormData?(r=t,r.append("cacheControl",s.cacheControl)):(r=t,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType);const c=this._removeEmptyFolders(e),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:n,body:r,headers:a},s?.duplex?{duplex:s.duplex}:{})),v=yield h.json();return h.ok?{data:{path:c,id:v.Id,fullPath:v.Key},error:null}:{data:null,error:v}}catch(r){if(re(r))return{data:null,error:r};throw r}})}upload(n,e,t){return _e(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",n,e,t)})}uploadToSignedUrl(n,e,t,i){return _e(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(n),s=this._getFinalPath(r),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",e);try{let c;const u=Object.assign({upsert:St.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",t)):typeof FormData<"u"&&t instanceof FormData?(c=t,c.append("cacheControl",u.cacheControl)):(c=t,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType);const v=yield this.fetch(a.toString(),{method:"PUT",body:c,headers:h}),M=yield v.json();return v.ok?{data:{path:r,fullPath:M.Key},error:null}:{data:null,error:M}}catch(c){if(re(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(n){return _e(this,void 0,void 0,function*(){try{let e=this._getFinalPath(n);const t=yield ye(this.fetch,`${this.url}/object/upload/sign/${e}`,{},{headers:this.headers}),i=new URL(this.url+t.url),r=i.searchParams.get("token");if(!r)throw new je("No token returned by API");return{data:{signedUrl:i.toString(),path:n,token:r},error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}update(n,e,t){return _e(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",n,e,t)})}move(n,e){return _e(this,void 0,void 0,function*(){try{return{data:yield ye(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:n,destinationKey:e},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}copy(n,e){return _e(this,void 0,void 0,function*(){try{return{data:{path:(yield ye(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:n,destinationKey:e},{headers:this.headers})).Key},error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}createSignedUrl(n,e,t){return _e(this,void 0,void 0,function*(){try{let i=this._getFinalPath(n),r=yield ye(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:this.headers});const s=t?.download?`&download=${!0===t.download?"":t.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${s}`)},{data:r,error:null}}catch(i){if(re(i))return{data:null,error:i};throw i}})}createSignedUrls(n,e,t){return _e(this,void 0,void 0,function*(){try{const i=yield ye(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:n},{headers:this.headers}),r=t?.download?`&download=${!0===t.download?"":t.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${r}`):null})),error:null}}catch(i){if(re(i))return{data:null,error:i};throw i}})}download(n,e){return _e(this,void 0,void 0,function*(){const i=typeof e?.transform<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString(e?.transform||{}),s=r?`?${r}`:"";try{const a=this._getFinalPath(n);return{data:yield(yield st(this.fetch,`${this.url}/${i}/${a}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(re(a))return{data:null,error:a};throw a}})}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],r=e?.download?`download=${!0===e.download?"":e.download}`:"";""!==r&&i.push(r);const a=typeof e?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(e?.transform||{});""!==c&&i.push(c);let u=i.join("&");return""!==u&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${u}`)}}}remove(n){return _e(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:n},{headers:this.headers}),error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}list(n,e,t){return _e(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},rn),e),{prefix:n||""});return{data:yield ye(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},t),error:null}}catch(i){if(re(i))return{data:null,error:i};throw i}})}_getFinalPath(n){return`${this.bucketId}/${n}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}}const sn={"X-Client-Info":"storage-js/2.5.5"};var Oe=function(o,n,e,t){return new(e||(e=Promise))(function(r,s){function a(h){try{u(t.next(h))}catch(v){s(v)}}function c(h){try{u(t.throw(h))}catch(v){s(v)}}function u(h){h.done?r(h.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(h.value).then(a,c)}u((t=t.apply(o,n||[])).next())})};class T{constructor(n,e={},t){this.url=n,this.headers=Object.assign(Object.assign({},sn),e),this.fetch=it(t)}listBuckets(){return Oe(this,void 0,void 0,function*(){try{return{data:yield st(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}getBucket(n){return Oe(this,void 0,void 0,function*(){try{return{data:yield st(this.fetch,`${this.url}/bucket/${n}`,{headers:this.headers}),error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}createBucket(n,e={public:!1}){return Oe(this,void 0,void 0,function*(){try{return{data:yield ye(this.fetch,`${this.url}/bucket`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}updateBucket(n,e){return Oe(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}emptyBucket(n){return Oe(this,void 0,void 0,function*(){try{return{data:yield ye(this.fetch,`${this.url}/bucket/${n}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}deleteBucket(n){return Oe(this,void 0,void 0,function*(){try{return{data:yield It(this.fetch,`${this.url}/bucket/${n}`,{},{headers:this.headers}),error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}}class p extends T{constructor(n,e={},t){super(n,e,t)}from(n){return new kt(this.url,this.headers,n,this.fetch)}}let b="";b=typeof Deno<"u"?"deno":typeof document<"u"?"web":typeof navigator<"u"&&"ReactNative"===navigator.product?"react-native":"node";const X={headers:{"X-Client-Info":`supabase-js-${b}/2.39.7`}},ae={schema:"public"},Ot={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ct={};const xt=(o,n,e)=>{const t=(o=>{let n;return n=o||(typeof fetch>"u"?w.default:fetch),(...e)=>n(...e)})(e),i=typeof Headers>"u"?w.Headers:Headers;return(r,s)=>function(o,n,e,t){return new(e||(e=Promise))(function(r,s){function a(h){try{u(t.next(h))}catch(v){s(v)}}function c(h){try{u(t.throw(h))}catch(v){s(v)}}function u(h){h.done?r(h.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(h.value).then(a,c)}u((t=t.apply(o,n||[])).next())})}(void 0,void 0,void 0,function*(){var a;const c=null!==(a=yield n())&&void 0!==a?a:o;let u=new i(s?.headers);return u.has("apikey")||u.set("apikey",o),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),t(r,Object.assign(Object.assign({},s),{headers:u}))})},pe=()=>typeof document<"u",Ce={tested:!1,writable:!1},ze=()=>{if(!pe())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch{return!1}if(Ce.tested)return Ce.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),Ce.tested=!0,Ce.writable=!0}catch{Ce.tested=!0,Ce.writable=!1}return Ce.writable};function Rt(o){const n={},e=new URL(o);if(e.hash&&"#"===e.hash[0])try{new URLSearchParams(e.hash.substring(1)).forEach((i,r)=>{n[r]=i})}catch{}return e.searchParams.forEach((t,i)=>{n[i]=t}),n}const on=o=>{let n;return n=o||(typeof fetch>"u"?(...e)=>Promise.resolve().then(E.bind(E,6397)).then(({default:t})=>t(...e)):fetch),(...e)=>n(...e)},Dn=o=>"object"==typeof o&&null!==o&&"status"in o&&"ok"in o&&"json"in o&&"function"==typeof o.json,xe=function(){var o=(0,d.Z)(function*(n,e,t){yield n.setItem(e,JSON.stringify(t))});return function(e,t,i){return o.apply(this,arguments)}}(),ut=function(){var o=(0,d.Z)(function*(n,e){const t=yield n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}});return function(e,t){return o.apply(this,arguments)}}(),Lt=function(){var o=(0,d.Z)(function*(n,e){yield n.removeItem(e)});return function(e,t){return o.apply(this,arguments)}}();class dt{constructor(){this.promise=new dt.promiseConstructor((n,e)=>{this.resolve=n,this.reject=e})}}function an(o){const e=o.split(".");if(3!==e.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");return JSON.parse(function Rn(o){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t,i,r,s,a,c,u,e="",h=0;for(o=o.replace("-","+").replace("_","/");h<o.length;)s=n.indexOf(o.charAt(h++)),a=n.indexOf(o.charAt(h++)),c=n.indexOf(o.charAt(h++)),u=n.indexOf(o.charAt(h++)),t=s<<2|a>>4,i=(15&a)<<4|c>>2,r=(3&c)<<6|u,e+=String.fromCharCode(t),64!=c&&0!=i&&(e+=String.fromCharCode(i)),64!=u&&0!=r&&(e+=String.fromCharCode(r));return e}(e[1]))}function Pt(){return(Pt=(0,d.Z)(function*(o){return yield new Promise(n=>{setTimeout(()=>n(null),o)})})).apply(this,arguments)}function Nn(o){return("0"+o.toString(16)).substr(-2)}function Ue(){const n=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let i="";for(let r=0;r<56;r++)i+=e.charAt(Math.floor(Math.random()*t));return i}return crypto.getRandomValues(n),Array.from(n,Nn).join("")}function Nt(){return(Nt=(0,d.Z)(function*(o){const e=(new TextEncoder).encode(o),t=yield crypto.subtle.digest("SHA-256",e),i=new Uint8Array(t);return Array.from(i).map(r=>String.fromCharCode(r)).join("")})).apply(this,arguments)}function $e(o){return Ft.apply(this,arguments)}function Ft(){return Ft=(0,d.Z)(function*(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const e=yield function Fn(o){return Nt.apply(this,arguments)}(o);return function jn(o){return btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(e)}),Ft.apply(this,arguments)}dt.promiseConstructor=Promise;class jt extends Error{constructor(n,e){super(n),this.__isAuthError=!0,this.name="AuthError",this.status=e}}function V(o){return"object"==typeof o&&null!==o&&"__isAuthError"in o}class Un extends jt{constructor(n,e){super(n,e),this.name="AuthApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class cn extends jt{constructor(n,e){super(n),this.name="AuthUnknownError",this.originalError=e}}class De extends jt{constructor(n,e,t){super(n),this.name=e,this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Be extends De{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class Ut extends De{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class ht extends De{constructor(n){super(n,"AuthInvalidCredentialsError",400)}}class Ye extends De{constructor(n,e=null){super(n,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ln extends De{constructor(n,e=null){super(n,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ft extends De{constructor(n,e){super(n,"AuthRetryableFetchError",e)}}function Je(o){return V(o)&&"AuthRetryableFetchError"===o.name}class un extends De{constructor(n,e,t){super(n,"AuthWeakPasswordError",e),this.reasons=t}}var dn=function(o,n){var e={};for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&n.indexOf(t)<0&&(e[t]=o[t]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(o);i<t.length;i++)n.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(o,t[i])&&(e[t[i]]=o[t[i]])}return e};const Re=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),hn=[502,503,504];function _t(o){return Me.apply(this,arguments)}function Me(){return(Me=(0,d.Z)(function*(o){if(!Dn(o))throw new ft(Re(o),0);if(hn.includes(o.status))throw new ft(Re(o),o.status);let n;try{n=yield o.json()}catch(e){throw new cn(Re(e),e)}throw"object"==typeof n&&n&&"object"==typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)?new un(Re(n),o.status,n.weak_password.reasons):new Un(Re(n),o.status||500)})).apply(this,arguments)}const fn=(o,n,e,t)=>{const i={method:o,headers:n?.headers||{}};return"GET"===o?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},n?.headers),i.body=JSON.stringify(t),Object.assign(Object.assign({},i),e))};function W(o,n,e,t){return pt.apply(this,arguments)}function pt(){return pt=(0,d.Z)(function*(o,n,e,t){var i;const r=Object.assign({},t?.headers);t?.jwt&&(r.Authorization=`Bearer ${t.jwt}`);const s=null!==(i=t?.query)&&void 0!==i?i:{};t?.redirectTo&&(s.redirect_to=t.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=yield function _n(o,n,e,t,i,r){return mt.apply(this,arguments)}(o,n,e+a,{headers:r,noResolveJson:t?.noResolveJson},{},t?.body);return t?.xform?t?.xform(c):{data:Object.assign({},c),error:null}}),pt.apply(this,arguments)}function mt(){return(mt=(0,d.Z)(function*(o,n,e,t,i,r){const s=fn(n,t,i,r);let a;try{a=yield o(e,s)}catch(c){throw console.error(c),new ft(Re(c),0)}if(a.ok||(yield _t(a)),t?.noResolveJson)return a;try{return yield a.json()}catch(c){yield _t(c)}})).apply(this,arguments)}function be(o){var n;let e=null;return function mn(o){return o.access_token&&o.refresh_token&&o.expires_in}(o)&&(e=Object.assign({},o),o.expires_at||(e.expires_at=function ct(o){return Math.round(Date.now()/1e3)+o}(o.expires_in))),{data:{session:e,user:null!==(n=o.user)&&void 0!==n?n:o},error:null}}function $t(o){const n=be(o);return!n.error&&o.weak_password&&"object"==typeof o.weak_password&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&"string"==typeof o.weak_password.message&&o.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(n.data.weak_password=o.weak_password),n}function Ie(o){var n;return{data:{user:null!==(n=o.user)&&void 0!==n?n:o},error:null}}function Bt(o){return{data:o,error:null}}function Le(o){const{action_link:n,email_otp:e,hashed_token:t,redirect_to:i,verification_type:r}=o,s=dn(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:n,email_otp:e,hashed_token:t,redirect_to:i,verification_type:r},user:Object.assign({},s)},error:null}}function pn(o){return o}class vn{constructor({url:n="",headers:e={},fetch:t}){this.url=n,this.headers=e,this.fetch=on(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(n,e="global"){var t=this;return(0,d.Z)(function*(){try{return yield W(t.fetch,"POST",`${t.url}/logout?scope=${e}`,{headers:t.headers,jwt:n,noResolveJson:!0}),{data:null,error:null}}catch(i){if(V(i))return{data:null,error:i};throw i}})()}inviteUserByEmail(n,e={}){var t=this;return(0,d.Z)(function*(){try{return yield W(t.fetch,"POST",`${t.url}/invite`,{body:{email:n,data:e.data},headers:t.headers,redirectTo:e.redirectTo,xform:Ie})}catch(i){if(V(i))return{data:{user:null},error:i};throw i}})()}generateLink(n){var e=this;return(0,d.Z)(function*(){try{const{options:t}=n,i=function(o,n){var e={};for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&n.indexOf(t)<0&&(e[t]=o[t]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(o);i<t.length;i++)n.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(o,t[i])&&(e[t[i]]=o[t[i]])}return e}(n,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i?.newEmail,delete r.newEmail),yield W(e.fetch,"POST",`${e.url}/admin/generate_link`,{body:r,headers:e.headers,xform:Le,redirectTo:t?.redirectTo})}catch(t){if(V(t))return{data:{properties:null,user:null},error:t};throw t}})()}createUser(n){var e=this;return(0,d.Z)(function*(){try{return yield W(e.fetch,"POST",`${e.url}/admin/users`,{body:n,headers:e.headers,xform:Ie})}catch(t){if(V(t))return{data:{user:null},error:t};throw t}})()}listUsers(n){var e=this;return(0,d.Z)(function*(){var t,i,r,s,a,c,u;try{const h={nextPage:null,lastPage:0,total:0},v=yield W(e.fetch,"GET",`${e.url}/admin/users`,{headers:e.headers,noResolveJson:!0,query:{page:null!==(i=null===(t=n?.page)||void 0===t?void 0:t.toString())&&void 0!==i?i:"",per_page:null!==(s=null===(r=n?.perPage)||void 0===r?void 0:r.toString())&&void 0!==s?s:""},xform:pn});if(v.error)throw v.error;const M=yield v.json(),x=null!==(a=v.headers.get("x-total-count"))&&void 0!==a?a:0,S=null!==(u=null===(c=v.headers.get("link"))||void 0===c?void 0:c.split(","))&&void 0!==u?u:[];return S.length>0&&(S.forEach(U=>{const z=parseInt(U.split(";")[0].split("=")[1].substring(0,1)),ne=JSON.parse(U.split(";")[1].split("=")[1]);h[`${ne}Page`]=z}),h.total=parseInt(x)),{data:Object.assign(Object.assign({},M),h),error:null}}catch(h){if(V(h))return{data:{users:[]},error:h};throw h}})()}getUserById(n){var e=this;return(0,d.Z)(function*(){try{return yield W(e.fetch,"GET",`${e.url}/admin/users/${n}`,{headers:e.headers,xform:Ie})}catch(t){if(V(t))return{data:{user:null},error:t};throw t}})()}updateUserById(n,e){var t=this;return(0,d.Z)(function*(){try{return yield W(t.fetch,"PUT",`${t.url}/admin/users/${n}`,{body:e,headers:t.headers,xform:Ie})}catch(i){if(V(i))return{data:{user:null},error:i};throw i}})()}deleteUser(n,e=!1){var t=this;return(0,d.Z)(function*(){try{return yield W(t.fetch,"DELETE",`${t.url}/admin/users/${n}`,{headers:t.headers,body:{should_soft_delete:e},xform:Ie})}catch(i){if(V(i))return{data:{user:null},error:i};throw i}})()}_listFactors(n){var e=this;return(0,d.Z)(function*(){try{const{data:t,error:i}=yield W(e.fetch,"GET",`${e.url}/admin/users/${n.userId}/factors`,{headers:e.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(V(t))return{data:null,error:t};throw t}})()}_deleteFactor(n){var e=this;return(0,d.Z)(function*(){try{return{data:yield W(e.fetch,"DELETE",`${e.url}/admin/users/${n.userId}/factors/${n.id}`,{headers:e.headers}),error:null}}catch(t){if(V(t))return{data:null,error:t};throw t}})()}}const yn={getItem:o=>ze()?globalThis.localStorage.getItem(o):null,setItem:(o,n)=>{ze()&&globalThis.localStorage.setItem(o,n)},removeItem:o=>{ze()&&globalThis.localStorage.removeItem(o)}};function bn(o={}){return{getItem:n=>o[n]||null,setItem:(n,e)=>{o[n]=e},removeItem:n=>{delete o[n]}}}const Ze={debug:!!(globalThis&&ze()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class Tn extends Error{constructor(n){super(n),this.isAcquireTimeout=!0}}class Vn extends Tn{}function Gn(o,n,e){return Kt.apply(this,arguments)}function Kt(){return Kt=(0,d.Z)(function*(o,n,e){Ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,n);const t=new globalThis.AbortController;return n>0&&setTimeout(()=>{t.abort(),Ze.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},n),yield globalThis.navigator.locks.request(o,0===n?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},function(){var i=(0,d.Z)(function*(r){if(!r){if(0===n)throw Ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new Vn(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Ze.debug)try{const s=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}Ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,r.name);try{return yield e()}finally{Ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,r.name)}});return function(r){return i.apply(this,arguments)}}())}),Kt.apply(this,arguments)}!function En(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}();const Hn={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:{"X-Client-Info":"gotrue-js/0.0.0"},flowType:"implicit",debug:!1},qe=3e4;function An(o,n,e){return Vt.apply(this,arguments)}function Vt(){return(Vt=(0,d.Z)(function*(o,n,e){return yield e()})).apply(this,arguments)}let Mn=(()=>{class o{constructor(e){var i,r,t=this;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=o.nextInstanceID,o.nextInstanceID+=1,this.instanceID>0&&pe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Hn),e);if(this.logDebugMessages=!!s.debug,"function"==typeof s.debug&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new vn({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=on(s.fetch),this.lock=s.lock||An,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.lock=s.lock?s.lock:pe()&&null!==(i=globalThis?.navigator)&&void 0!==i&&i.locks?Gn:An,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:ze()?this.storage=yn:(this.memoryStorage={},this.storage=bn(this.memoryStorage)):(this.memoryStorage={},this.storage=bn(this.memoryStorage)),pe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",function(){var a=(0,d.Z)(function*(c){t._debug("received broadcast notification from other tab or client",c),yield t._notifyAllSubscribers(c.data.event,c.data.session,!1)});return function(c){return a.apply(this,arguments)}}())}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (0.0.0) ${(new Date).toISOString()}`,...e),this}initialize(){var e=this;return(0,d.Z)(function*(){return e.initializePromise||(e.initializePromise=(0,d.Z)(function*(){return yield e._acquireLock(-1,(0,d.Z)(function*(){return yield e._initialize()}))})()),yield e.initializePromise})()}_initialize(){var e=this;return(0,d.Z)(function*(){try{const t=!!pe()&&(yield e._isPKCEFlow());if(e._debug("#_initialize()","begin","is PKCE flow",t),t||e.detectSessionInUrl&&e._isImplicitGrantFlow()){const{data:i,error:r}=yield e._getSessionFromURL(t);if(r)return e._debug("#_initialize()","error detecting session from URL",r),"Identity is already linked"===r?.message||"Identity is already linked to another user"===r?.message||(yield e._removeSession()),{error:r};const{session:s,redirectType:a}=i;return e._debug("#_initialize()","detected session in URL",s,"redirect type",a),yield e._saveSession(s),setTimeout((0,d.Z)(function*(){"recovery"===a?yield e._notifyAllSubscribers("PASSWORD_RECOVERY",s):yield e._notifyAllSubscribers("SIGNED_IN",s)}),0),{error:null}}return yield e._recoverAndRefresh(),{error:null}}catch(t){return V(t)?{error:t}:{error:new cn("Unexpected error during initialization",t)}}finally{yield e._handleVisibilityChange(),e._debug("#_initialize()","end")}})()}signUp(e){var t=this;return(0,d.Z)(function*(){var i,r,s;try{let a;if(yield t._removeSession(),"email"in e){const{email:M,password:x,options:S}=e;let U=null,z=null;if("pkce"===t.flowType){const ne=Ue();yield xe(t.storage,`${t.storageKey}-code-verifier`,ne),U=yield $e(ne),z=ne===U?"plain":"s256"}a=yield W(t.fetch,"POST",`${t.url}/signup`,{headers:t.headers,redirectTo:S?.emailRedirectTo,body:{email:M,password:x,data:null!==(i=S?.data)&&void 0!==i?i:{},gotrue_meta_security:{captcha_token:S?.captchaToken},code_challenge:U,code_challenge_method:z},xform:be})}else{if(!("phone"in e))throw new ht("You must provide either an email or phone number and a password");{const{phone:M,password:x,options:S}=e;a=yield W(t.fetch,"POST",`${t.url}/signup`,{headers:t.headers,body:{phone:M,password:x,data:null!==(r=S?.data)&&void 0!==r?r:{},channel:null!==(s=S?.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:S?.captchaToken}},xform:be})}}const{data:c,error:u}=a;if(u||!c)return{data:{user:null,session:null},error:u};const h=c.session,v=c.user;return c.session&&(yield t._saveSession(c.session),yield t._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:v,session:h},error:null}}catch(a){if(V(a))return{data:{user:null,session:null},error:a};throw a}})()}signInWithPassword(e){var t=this;return(0,d.Z)(function*(){try{let i;if(yield t._removeSession(),"email"in e){const{email:a,password:c,options:u}=e;i=yield W(t.fetch,"POST",`${t.url}/token?grant_type=password`,{headers:t.headers,body:{email:a,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:$t})}else{if(!("phone"in e))throw new ht("You must provide either an email or phone number and a password");{const{phone:a,password:c,options:u}=e;i=yield W(t.fetch,"POST",`${t.url}/token?grant_type=password`,{headers:t.headers,body:{phone:a,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:$t})}}const{data:r,error:s}=i;return s?{data:{user:null,session:null},error:s}:r&&r.session&&r.user?(r.session&&(yield t._saveSession(r.session),yield t._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s}):{data:{user:null,session:null},error:new Ut}}catch(i){if(V(i))return{data:{user:null,session:null},error:i};throw i}})()}signInWithOAuth(e){var t=this;return(0,d.Z)(function*(){var i,r,s,a;return yield t._removeSession(),yield t._handleProviderSignIn(e.provider,{redirectTo:null===(i=e.options)||void 0===i?void 0:i.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})})()}exchangeCodeForSession(e){var t=this;return(0,d.Z)(function*(){return yield t.initializePromise,t._acquireLock(-1,(0,d.Z)(function*(){return t._exchangeCodeForSession(e)}))})()}_exchangeCodeForSession(e){var t=this;return(0,d.Z)(function*(){const i=yield ut(t.storage,`${t.storageKey}-code-verifier`),[r,s]=(i??"").split("/"),{data:a,error:c}=yield W(t.fetch,"POST",`${t.url}/token?grant_type=pkce`,{headers:t.headers,body:{auth_code:e,code_verifier:r},xform:be});return yield Lt(t.storage,`${t.storageKey}-code-verifier`),c?{data:{user:null,session:null,redirectType:null},error:c}:a&&a.session&&a.user?(a.session&&(yield t._saveSession(a.session),yield t._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:c}):{data:{user:null,session:null,redirectType:null},error:new Ut}})()}signInWithIdToken(e){var t=this;return(0,d.Z)(function*(){yield t._removeSession();try{const{options:i,provider:r,token:s,access_token:a,nonce:c}=e,u=yield W(t.fetch,"POST",`${t.url}/token?grant_type=id_token`,{headers:t.headers,body:{provider:r,id_token:s,access_token:a,nonce:c,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:be}),{data:h,error:v}=u;return v?{data:{user:null,session:null},error:v}:h&&h.session&&h.user?(h.session&&(yield t._saveSession(h.session),yield t._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:v}):{data:{user:null,session:null},error:new Ut}}catch(i){if(V(i))return{data:{user:null,session:null},error:i};throw i}})()}signInWithOtp(e){var t=this;return(0,d.Z)(function*(){var i,r,s,a,c;try{if(yield t._removeSession(),"email"in e){const{email:u,options:h}=e;let v=null,M=null;if("pkce"===t.flowType){const S=Ue();yield xe(t.storage,`${t.storageKey}-code-verifier`,S),v=yield $e(S),M=S===v?"plain":"s256"}const{error:x}=yield W(t.fetch,"POST",`${t.url}/otp`,{headers:t.headers,body:{email:u,data:null!==(i=h?.data)&&void 0!==i?i:{},create_user:null===(r=h?.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:v,code_challenge_method:M},redirectTo:h?.emailRedirectTo});return{data:{user:null,session:null},error:x}}if("phone"in e){const{phone:u,options:h}=e,{data:v,error:M}=yield W(t.fetch,"POST",`${t.url}/otp`,{headers:t.headers,body:{phone:u,data:null!==(s=h?.data)&&void 0!==s?s:{},create_user:null===(a=h?.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:null!==(c=h?.channel)&&void 0!==c?c:"sms"}});return{data:{user:null,session:null,messageId:v?.message_id},error:M}}throw new ht("You must provide either an email or phone number.")}catch(u){if(V(u))return{data:{user:null,session:null},error:u};throw u}})()}verifyOtp(e){var t=this;return(0,d.Z)(function*(){var i,r;try{let s,a;"email_change"!==e.type&&"phone_change"!==e.type&&(yield t._removeSession()),"options"in e&&(s=null===(i=e.options)||void 0===i?void 0:i.redirectTo,a=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:c,error:u}=yield W(t.fetch,"POST",`${t.url}/verify`,{headers:t.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:be});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,v=c.user;return h?.access_token&&(yield t._saveSession(h),yield t._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:v,session:h},error:null}}catch(s){if(V(s))return{data:{user:null,session:null},error:s};throw s}})()}signInWithSSO(e){var t=this;return(0,d.Z)(function*(){var i,r,s;try{yield t._removeSession();let a=null,c=null;if("pkce"===t.flowType){const u=Ue();yield xe(t.storage,`${t.storageKey}-code-verifier`,u),a=yield $e(u),c=u===a?"plain":"s256"}return yield W(t.fetch,"POST",`${t.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(i=e.options)||void 0===i?void 0:i.redirectTo)&&void 0!==r?r:void 0}),null!==(s=e?.options)&&void 0!==s&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:c}),headers:t.headers,xform:Bt})}catch(a){if(V(a))return{data:null,error:a};throw a}})()}reauthenticate(){var e=this;return(0,d.Z)(function*(){return yield e.initializePromise,yield e._acquireLock(-1,(0,d.Z)(function*(){return yield e._reauthenticate()}))})()}_reauthenticate(){var e=this;return(0,d.Z)(function*(){try{return yield e._useSession(function(){var t=(0,d.Z)(function*(i){const{data:{session:r},error:s}=i;if(s)throw s;if(!r)throw new Be;const{error:a}=yield W(e.fetch,"GET",`${e.url}/reauthenticate`,{headers:e.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}});return function(i){return t.apply(this,arguments)}}())}catch(t){if(V(t))return{data:{user:null,session:null},error:t};throw t}})()}resend(e){var t=this;return(0,d.Z)(function*(){try{"email_change"!=e.type&&"phone_change"!=e.type&&(yield t._removeSession());const i=`${t.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:c}=yield W(t.fetch,"POST",i,{headers:t.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:c}}if("phone"in e){const{phone:r,type:s,options:a}=e,{data:c,error:u}=yield W(t.fetch,"POST",i,{headers:t.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new ht("You must provide either an email or phone number and a type")}catch(i){if(V(i))return{data:{user:null,session:null},error:i};throw i}})()}getSession(){var e=this;return(0,d.Z)(function*(){return yield e.initializePromise,e._acquireLock(-1,(0,d.Z)(function*(){return e._useSession(function(){var t=(0,d.Z)(function*(i){return i});return function(i){return t.apply(this,arguments)}}())}))})()}_acquireLock(e,t){var i=this;return(0,d.Z)(function*(){i._debug("#_acquireLock","begin",e);try{if(i.lockAcquired){const r=i.pendingInLock.length?i.pendingInLock[i.pendingInLock.length-1]:Promise.resolve(),s=(0,d.Z)(function*(){return yield r,yield t()})();return i.pendingInLock.push((0,d.Z)(function*(){try{yield s}catch{}})()),s}return yield i.lock(`lock:${i.storageKey}`,e,(0,d.Z)(function*(){i._debug("#_acquireLock","lock acquired for storage key",i.storageKey);try{i.lockAcquired=!0;const r=t();for(i.pendingInLock.push((0,d.Z)(function*(){try{yield r}catch{}})()),yield r;i.pendingInLock.length;){const s=[...i.pendingInLock];yield Promise.all(s),i.pendingInLock.splice(0,s.length)}return yield r}finally{i._debug("#_acquireLock","lock released for storage key",i.storageKey),i.lockAcquired=!1}}))}finally{i._debug("#_acquireLock","end")}})()}_useSession(e){var t=this;return(0,d.Z)(function*(){t._debug("#_useSession","begin");try{const i=yield t.__loadSession();return yield e(i)}finally{t._debug("#_useSession","end")}})()}__loadSession(){var e=this;return(0,d.Z)(function*(){e._debug("#__loadSession()","begin"),e.lockAcquired||e._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let t=null;const i=yield ut(e.storage,e.storageKey);if(e._debug("#getSession()","session from storage",i),null!==i&&(e._isValidSession(i)?t=i:(e._debug("#getSession()","session from storage is not valid"),yield e._removeSession())),!t)return{data:{session:null},error:null};const r=!!t.expires_at&&t.expires_at<=Date.now()/1e3;if(e._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r)return{data:{session:t},error:null};const{session:s,error:a}=yield e._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{e._debug("#__loadSession()","end")}})()}getUser(e){var t=this;return(0,d.Z)(function*(){return e?yield t._getUser(e):(yield t.initializePromise,t._acquireLock(-1,(0,d.Z)(function*(){return yield t._getUser()})))})()}_getUser(e){var t=this;return(0,d.Z)(function*(){try{return e?yield W(t.fetch,"GET",`${t.url}/user`,{headers:t.headers,jwt:e,xform:Ie}):yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s,a;const{data:c,error:u}=r;if(u)throw u;return yield W(t.fetch,"GET",`${t.url}/user`,{headers:t.headers,jwt:null!==(a=null===(s=c.session)||void 0===s?void 0:s.access_token)&&void 0!==a?a:void 0,xform:Ie})});return function(r){return i.apply(this,arguments)}}())}catch(i){if(V(i))return{data:{user:null},error:i};throw i}})()}updateUser(e,t={}){var i=this;return(0,d.Z)(function*(){return yield i.initializePromise,yield i._acquireLock(-1,(0,d.Z)(function*(){return yield i._updateUser(e,t)}))})()}_updateUser(e,t={}){var i=this;return(0,d.Z)(function*(){try{return yield i._useSession(function(){var r=(0,d.Z)(function*(s){const{data:a,error:c}=s;if(c)throw c;if(!a.session)throw new Be;const u=a.session;let h=null,v=null;if("pkce"===i.flowType&&null!=e.email){const S=Ue();yield xe(i.storage,`${i.storageKey}-code-verifier`,S),h=yield $e(S),v=S===h?"plain":"s256"}const{data:M,error:x}=yield W(i.fetch,"PUT",`${i.url}/user`,{headers:i.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:v}),jwt:u.access_token,xform:Ie});if(x)throw x;return u.user=M.user,yield i._saveSession(u),yield i._notifyAllSubscribers("USER_UPDATED",u),{data:{user:u.user},error:null}});return function(s){return r.apply(this,arguments)}}())}catch(r){if(V(r))return{data:{user:null},error:r};throw r}})()}_decodeJWT(e){return an(e)}setSession(e){var t=this;return(0,d.Z)(function*(){return yield t.initializePromise,yield t._acquireLock(-1,(0,d.Z)(function*(){return yield t._setSession(e)}))})()}_setSession(e){var t=this;return(0,d.Z)(function*(){try{if(!e.access_token||!e.refresh_token)throw new Be;const i=Date.now()/1e3;let r=i,s=!0,a=null;const c=an(e.access_token);if(c.exp&&(r=c.exp,s=r<=i),s){const{session:u,error:h}=yield t._callRefreshToken(e.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!u)return{data:{user:null,session:null},error:null};a=u}else{const{data:u,error:h}=yield t._getUser(e.access_token);if(h)throw h;a={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:r-i,expires_at:r},yield t._saveSession(a),yield t._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(i){if(V(i))return{data:{session:null,user:null},error:i};throw i}})()}refreshSession(e){var t=this;return(0,d.Z)(function*(){return yield t.initializePromise,yield t._acquireLock(-1,(0,d.Z)(function*(){return yield t._refreshSession(e)}))})()}_refreshSession(e){var t=this;return(0,d.Z)(function*(){try{return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s;if(!e){const{data:u,error:h}=r;if(h)throw h;e=null!==(s=u.session)&&void 0!==s?s:void 0}if(!e?.refresh_token)throw new Be;const{session:a,error:c}=yield t._callRefreshToken(e.refresh_token);return c?{data:{user:null,session:null},error:c}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}});return function(r){return i.apply(this,arguments)}}())}catch(i){if(V(i))return{data:{user:null,session:null},error:i};throw i}})()}_getSessionFromURL(e){var t=this;return(0,d.Z)(function*(){try{if(!pe())throw new Ye("No browser detected.");if("implicit"===t.flowType&&!t._isImplicitGrantFlow())throw new Ye("Not a valid implicit grant flow url.");if("pkce"==t.flowType&&!e)throw new ln("Not a valid PKCE flow url.");const i=Rt(window.location.href);if(e){if(!i.code)throw new ln("No code detected.");const{data:ce,error:me}=yield t._exchangeCodeForSession(i.code);if(me)throw me;const Ht=new URL(window.location.href);return Ht.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Ht.toString()),{data:{session:ce.session,redirectType:null},error:null}}if(i.error||i.error_description||i.error_code)throw new Ye(i.error_description||"Error in URL with unspecified error_description",{error:i.error||"unspecified_error",code:i.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:c,expires_in:u,expires_at:h,token_type:v}=i;if(!(a&&u&&c&&v))throw new Ye("No session defined in URL");const M=Math.round(Date.now()/1e3),x=parseInt(u);let S=M+x;h&&(S=parseInt(h));const U=S-M;1e3*U<=qe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${U}s, should have been closer to ${x}s`);const z=S-x;M-z>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",z,S,M):M-z<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",z,S,M);const{data:ne,error:ue}=yield t._getUser(a);if(ue)throw ue;const he={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:x,expires_at:S,refresh_token:c,token_type:v,user:ne.user};return window.location.hash="",t._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:he,redirectType:i.type},error:null}}catch(i){if(V(i))return{data:{session:null,redirectType:null},error:i};throw i}})()}_isImplicitGrantFlow(){const e=Rt(window.location.href);return!(!pe()||!e.access_token&&!e.error_description)}_isPKCEFlow(){var e=this;return(0,d.Z)(function*(){const t=Rt(window.location.href),i=yield ut(e.storage,`${e.storageKey}-code-verifier`);return!(!t.code||!i)})()}signOut(e={scope:"global"}){var t=this;return(0,d.Z)(function*(){return yield t.initializePromise,yield t._acquireLock(-1,(0,d.Z)(function*(){return yield t._signOut(e)}))})()}_signOut({scope:e}={scope:"global"}){var t=this;return(0,d.Z)(function*(){return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s;const{data:a,error:c}=r;if(c)return{error:c};const u=null===(s=a.session)||void 0===s?void 0:s.access_token;if(u){const{error:h}=yield t.admin.signOut(u,e);if(h&&(!function $n(o){return V(o)&&"AuthApiError"===o.name}(h)||404!==h.status&&401!==h.status))return{error:h}}return"others"!==e&&(yield t._removeSession(),yield Lt(t.storage,`${t.storageKey}-code-verifier`),yield t._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}});return function(r){return i.apply(this,arguments)}}())})()}onAuthStateChange(e){var t=this;const i=function lt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const n=16*Math.random()|0;return("x"==o?n:3&n|8).toString(16)})}(),r={id:i,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,r),(0,d.Z)(function*(){yield t.initializePromise,yield t._acquireLock(-1,(0,d.Z)(function*(){t._emitInitialSession(i)}))})(),{data:{subscription:r}}}_emitInitialSession(e){var t=this;return(0,d.Z)(function*(){return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s,a;try{const{data:{session:c},error:u}=r;if(u)throw u;yield null===(s=t.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",c),t._debug("INITIAL_SESSION","callback id",e,"session",c)}catch(c){yield null===(a=t.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",null),t._debug("INITIAL_SESSION","callback id",e,"error",c),console.error(c)}});return function(r){return i.apply(this,arguments)}}())})()}resetPasswordForEmail(e,t={}){var i=this;return(0,d.Z)(function*(){let r=null,s=null;if("pkce"===i.flowType){const a=Ue();yield xe(i.storage,`${i.storageKey}-code-verifier`,`${a}/PASSWORD_RECOVERY`),r=yield $e(a),s=a===r?"plain":"s256"}try{return yield W(i.fetch,"POST",`${i.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:i.headers,redirectTo:t.redirectTo})}catch(a){if(V(a))return{data:null,error:a};throw a}})()}getUserIdentities(){var e=this;return(0,d.Z)(function*(){var t;try{const{data:i,error:r}=yield e.getUser();if(r)throw r;return{data:{identities:null!==(t=i.user.identities)&&void 0!==t?t:[]},error:null}}catch(i){if(V(i))return{data:null,error:i};throw i}})()}linkIdentity(e){var t=this;return(0,d.Z)(function*(){var i;try{const{data:r,error:s}=yield t._useSession(function(){var a=(0,d.Z)(function*(c){var u,h,v,M,x;const{data:S,error:U}=c;if(U)throw U;const z=yield t._getUrlForProvider(`${t.url}/user/identities/authorize`,e.provider,{redirectTo:null===(u=e.options)||void 0===u?void 0:u.redirectTo,scopes:null===(h=e.options)||void 0===h?void 0:h.scopes,queryParams:null===(v=e.options)||void 0===v?void 0:v.queryParams,skipBrowserRedirect:!0});return yield W(t.fetch,"GET",z,{headers:t.headers,jwt:null!==(x=null===(M=S.session)||void 0===M?void 0:M.access_token)&&void 0!==x?x:void 0})});return function(c){return a.apply(this,arguments)}}());if(s)throw s;return pe()&&!(null!==(i=e.options)&&void 0!==i&&i.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(V(r))return{data:{provider:e.provider,url:null},error:r};throw r}})()}unlinkIdentity(e){var t=this;return(0,d.Z)(function*(){try{return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s,a;const{data:c,error:u}=r;if(u)throw u;return yield W(t.fetch,"DELETE",`${t.url}/user/identities/${e.identity_id}`,{headers:t.headers,jwt:null!==(a=null===(s=c.session)||void 0===s?void 0:s.access_token)&&void 0!==a?a:void 0})});return function(r){return i.apply(this,arguments)}}())}catch(i){if(V(i))return{data:null,error:i};throw i}})()}_refreshAccessToken(e){var t=this;return(0,d.Z)(function*(){const i=`#_refreshAccessToken(${e.substring(0,5)}...)`;t._debug(i,"begin");try{const r=Date.now();return yield function Pn(o,n){return new Promise((t,i)=>{(0,d.Z)(function*(){for(let r=0;r<1/0;r++)try{const s=yield o(r);if(!n(r,null,s))return void t(s)}catch(s){if(!n(r,s))return void i(s)}})()})}(function(){var s=(0,d.Z)(function*(a){return yield function Ln(o){return Pt.apply(this,arguments)}(200*a),t._debug(i,"refreshing attempt",a),yield W(t.fetch,"POST",`${t.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:t.headers,xform:be})});return function(a){return s.apply(this,arguments)}}(),(s,a,c)=>c&&c.error&&Je(c.error)&&Date.now()+200*(s+1)-r<qe)}catch(r){if(t._debug(i,"error",r),V(r))return{data:{session:null,user:null},error:r};throw r}finally{t._debug(i,"end")}})()}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,t){var i=this;return(0,d.Z)(function*(){const r=yield i._getUrlForProvider(`${i.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return i._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),pe()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}})()}_recoverAndRefresh(){var e=this;return(0,d.Z)(function*(){var t;const i="#_recoverAndRefresh()";e._debug(i,"begin");try{const r=yield ut(e.storage,e.storageKey);if(e._debug(i,"session from storage",r),!e._isValidSession(r))return e._debug(i,"session is not valid"),void(null!==r&&(yield e._removeSession()));const s=Math.round(Date.now()/1e3),a=(null!==(t=r.expires_at)&&void 0!==t?t:1/0)<s+10;if(e._debug(i,`session has${a?"":" not"} expired with margin of 10s`),a){if(e.autoRefreshToken&&r.refresh_token){const{error:c}=yield e._callRefreshToken(r.refresh_token);c&&(console.error(c),Je(c)||(e._debug(i,"refresh failed with a non-retryable error, removing the session",c),yield e._removeSession()))}}else yield e._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return e._debug(i,"error",r),void console.error(r)}finally{e._debug(i,"end")}})()}_callRefreshToken(e){var t=this;return(0,d.Z)(function*(){var i,r;if(!e)throw new Be;if(t.refreshingDeferred)return t.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;t._debug(s,"begin");try{t.refreshingDeferred=new dt;const{data:a,error:c}=yield t._refreshAccessToken(e);if(c)throw c;if(!a.session)throw new Be;yield t._saveSession(a.session),yield t._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const u={session:a.session,error:null};return t.refreshingDeferred.resolve(u),u}catch(a){if(t._debug(s,"error",a),V(a)){const c={session:null,error:a};return Je(a)||(yield t._removeSession(),yield t._notifyAllSubscribers("SIGNED_OUT",null)),null===(i=t.refreshingDeferred)||void 0===i||i.resolve(c),c}throw null===(r=t.refreshingDeferred)||void 0===r||r.reject(a),a}finally{t.refreshingDeferred=null,t._debug(s,"end")}})()}_notifyAllSubscribers(e,t,i=!0){var r=this;return(0,d.Z)(function*(){const s=`#_notifyAllSubscribers(${e})`;r._debug(s,"begin",t,`broadcast = ${i}`);try{r.broadcastChannel&&i&&r.broadcastChannel.postMessage({event:e,session:t});const a=[],c=Array.from(r.stateChangeEmitters.values()).map(function(){var u=(0,d.Z)(function*(h){try{yield h.callback(e,t)}catch(v){a.push(v)}});return function(h){return u.apply(this,arguments)}}());if(yield Promise.all(c),a.length>0){for(let u=0;u<a.length;u+=1)console.error(a[u]);throw a[0]}}finally{r._debug(s,"end")}})()}_saveSession(e){var t=this;return(0,d.Z)(function*(){t._debug("#_saveSession()",e),yield xe(t.storage,t.storageKey,e)})()}_removeSession(){var e=this;return(0,d.Z)(function*(){e._debug("#_removeSession()"),yield Lt(e.storage,e.storageKey)})()}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&pe()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}_startAutoRefresh(){var e=this;return(0,d.Z)(function*(){yield e._stopAutoRefresh(),e._debug("#_startAutoRefresh()");const t=setInterval(()=>e._autoRefreshTokenTick(),qe);e.autoRefreshTicker=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():typeof Deno<"u"&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t),setTimeout((0,d.Z)(function*(){yield e.initializePromise,yield e._autoRefreshTokenTick()}),0)})()}_stopAutoRefresh(){var e=this;return(0,d.Z)(function*(){e._debug("#_stopAutoRefresh()");const t=e.autoRefreshTicker;e.autoRefreshTicker=null,t&&clearInterval(t)})()}startAutoRefresh(){var e=this;return(0,d.Z)(function*(){e._removeVisibilityChangedCallback(),yield e._startAutoRefresh()})()}stopAutoRefresh(){var e=this;return(0,d.Z)(function*(){e._removeVisibilityChangedCallback(),yield e._stopAutoRefresh()})()}_autoRefreshTokenTick(){var e=this;return(0,d.Z)(function*(){e._debug("#_autoRefreshTokenTick()","begin");try{yield e._acquireLock(0,(0,d.Z)(function*(){try{const t=Date.now();try{return yield e._useSession(function(){var i=(0,d.Z)(function*(r){const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at)return void e._debug("#_autoRefreshTokenTick()","no session");const a=Math.floor((1e3*s.expires_at-t)/qe);e._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),a<=3&&(yield e._callRefreshToken(s.refresh_token))});return function(r){return i.apply(this,arguments)}}())}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{e._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(!(t.isAcquireTimeout||t instanceof Tn))throw t;e._debug("auto refresh token tick lock not available")}})()}_handleVisibilityChange(){var e=this;return(0,d.Z)(function*(){if(e._debug("#_handleVisibilityChange()"),!pe()||!window?.addEventListener)return e.autoRefreshToken&&e.startAutoRefresh(),!1;try{e.visibilityChangedCallback=(0,d.Z)(function*(){return yield e._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",e.visibilityChangedCallback),yield e._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})()}_onVisibilityChanged(e){var t=this;return(0,d.Z)(function*(){const i=`#_onVisibilityChanged(${e})`;t._debug(i,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(t.autoRefreshToken&&t._startAutoRefresh(),e||(yield t.initializePromise,yield t._acquireLock(-1,(0,d.Z)(function*(){"visible"===document.visibilityState?yield t._recoverAndRefresh():t._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&t.autoRefreshToken&&t._stopAutoRefresh()})()}_getUrlForProvider(e,t,i){var r=this;return(0,d.Z)(function*(){const s=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&s.push(`scopes=${encodeURIComponent(i.scopes)}`),"pkce"===r.flowType){const a=Ue();yield xe(r.storage,`${r.storageKey}-code-verifier`,a);const c=yield $e(a),u=a===c?"plain":"s256";r._debug("PKCE","code verifier",`${a.substring(0,5)}...`,"code challenge",c,"method",u);const h=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(u)}`});s.push(h.toString())}if(i?.queryParams){const a=new URLSearchParams(i.queryParams);s.push(a.toString())}return i?.skipBrowserRedirect&&s.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${s.join("&")}`})()}_unenroll(e){var t=this;return(0,d.Z)(function*(){try{return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s;const{data:a,error:c}=r;return c?{data:null,error:c}:yield W(t.fetch,"DELETE",`${t.url}/factors/${e.factorId}`,{headers:t.headers,jwt:null===(s=a?.session)||void 0===s?void 0:s.access_token})});return function(r){return i.apply(this,arguments)}}())}catch(i){if(V(i))return{data:null,error:i};throw i}})()}_enroll(e){var t=this;return(0,d.Z)(function*(){try{return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s,a;const{data:c,error:u}=r;if(u)return{data:null,error:u};const{data:h,error:v}=yield W(t.fetch,"POST",`${t.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:t.headers,jwt:null===(s=c?.session)||void 0===s?void 0:s.access_token});return v?{data:null,error:v}:(!(null===(a=h?.totp)||void 0===a)&&a.qr_code&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})});return function(r){return i.apply(this,arguments)}}())}catch(i){if(V(i))return{data:null,error:i};throw i}})()}_verify(e){var t=this;return(0,d.Z)(function*(){return t._acquireLock(-1,(0,d.Z)(function*(){try{return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s;const{data:a,error:c}=r;if(c)return{data:null,error:c};const{data:u,error:h}=yield W(t.fetch,"POST",`${t.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:t.headers,jwt:null===(s=a?.session)||void 0===s?void 0:s.access_token});return h?{data:null,error:h}:(yield t._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),yield t._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),{data:u,error:h})});return function(r){return i.apply(this,arguments)}}())}catch(i){if(V(i))return{data:null,error:i};throw i}}))})()}_challenge(e){var t=this;return(0,d.Z)(function*(){return t._acquireLock(-1,(0,d.Z)(function*(){try{return yield t._useSession(function(){var i=(0,d.Z)(function*(r){var s;const{data:a,error:c}=r;return c?{data:null,error:c}:yield W(t.fetch,"POST",`${t.url}/factors/${e.factorId}/challenge`,{headers:t.headers,jwt:null===(s=a?.session)||void 0===s?void 0:s.access_token})});return function(r){return i.apply(this,arguments)}}())}catch(i){if(V(i))return{data:null,error:i};throw i}}))})()}_challengeAndVerify(e){var t=this;return(0,d.Z)(function*(){const{data:i,error:r}=yield t._challenge({factorId:e.factorId});return r?{data:null,error:r}:yield t._verify({factorId:e.factorId,challengeId:i.id,code:e.code})})()}_listFactors(){var e=this;return(0,d.Z)(function*(){const{data:{user:t},error:i}=yield e.getUser();if(i)return{data:null,error:i};const r=t?.factors||[],s=r.filter(a=>"totp"===a.factor_type&&"verified"===a.status);return{data:{all:r,totp:s},error:null}})()}_getAuthenticatorAssuranceLevel(){var e=this;return(0,d.Z)(function*(){return e._acquireLock(-1,(0,d.Z)(function*(){return yield e._useSession(function(){var t=(0,d.Z)(function*(i){var r,s;const{data:{session:a},error:c}=i;if(c)return{data:null,error:c};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const u=e._decodeJWT(a.access_token);let h=null;u.aal&&(h=u.aal);let v=h;return(null!==(s=null===(r=a.user.factors)||void 0===r?void 0:r.filter(S=>"verified"===S.status))&&void 0!==s?s:[]).length>0&&(v="aal2"),{data:{currentLevel:h,nextLevel:v,currentAuthenticationMethods:u.amr||[]},error:null}});return function(i){return t.apply(this,arguments)}}())}))})()}}return o.nextInstanceID=0,o})();class Gt extends Mn{constructor(n){super(n)}}class Xn{constructor(n,e,t){var i,r,s,a,c,u,h,v;if(this.supabaseUrl=n,this.supabaseKey=e,!n)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const M=function We(o){return o.replace(/\/$/,"")}(n);this.realtimeUrl=`${M}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${M}/auth/v1`,this.storageUrl=`${M}/storage/v1`,this.functionsUrl=`${M}/functions/v1`;const x=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,U=function at(o,n){const{db:e,auth:t,realtime:i,global:r}=o,{db:s,auth:a,realtime:c,global:u}=n;return{db:Object.assign(Object.assign({},s),e),auth:Object.assign(Object.assign({},a),t),realtime:Object.assign(Object.assign({},c),i),global:Object.assign(Object.assign({},u),r)}}(t??{},{db:ae,realtime:Ct,auth:Object.assign(Object.assign({},Ot),{storageKey:x}),global:X});this.storageKey=null!==(r=null===(i=U.auth)||void 0===i?void 0:i.storageKey)&&void 0!==r?r:"",this.headers=null!==(a=null===(s=U.global)||void 0===s?void 0:s.headers)&&void 0!==a?a:{},this.auth=this._initSupabaseAuthClient(null!==(c=U.auth)&&void 0!==c?c:{},this.headers,null===(u=U.global)||void 0===u?void 0:u.fetch),this.fetch=xt(e,this._getAccessToken.bind(this),null===(h=U.global)||void 0===h?void 0:h.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},U.realtime)),this.rest=new se(`${M}/rest/v1`,{headers:this.headers,schema:null===(v=U.db)||void 0===v?void 0:v.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new F(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new p(this.storageUrl,this.headers,this.fetch)}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var n,e;return function(o,n,e,t){return new(e||(e=Promise))(function(r,s){function a(h){try{u(t.next(h))}catch(v){s(v)}}function c(h){try{u(t.throw(h))}catch(v){s(v)}}function u(h){h.done?r(h.value):function i(r){return r instanceof e?r:new e(function(s){s(r)})}(h.value).then(a,c)}u((t=t.apply(o,n||[])).next())})}(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return null!==(e=null===(n=t.session)||void 0===n?void 0:n.access_token)&&void 0!==e?e:null})}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,storageKey:r,flowType:s,debug:a},c,u){return new Gt({url:this.authUrl,headers:Object.assign(Object.assign({},{Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`}),c),storageKey:r,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,flowType:s,debug:a,fetch:u})}_initRealtimeClient(n){return new tt(this.realtimeUrl,Object.assign(Object.assign({},n),{params:Object.assign({apikey:this.supabaseKey},n?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(n,e,t){"TOKEN_REFRESHED"!==n&&"SIGNED_IN"!==n||this.changedAccessToken===t?"SIGNED_OUT"===n&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==e&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(t??null),this.changedAccessToken=t)}}var ei=E(8274);let ti=(()=>{class o{constructor(){this.supabase_client=new Xn("https://zlmaryslxtjmktervpuh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpsbWFyeXNseHRqbWt0ZXJ2cHVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDcyNDIwODcsImV4cCI6MjAyMjgxODA4N30.F8sA2x4pahe8XJfeMgSnesqMkQ1KhyCQvXlUEJ0Ou-c",void 0)}getData(e){var t=this;return(0,d.Z)(function*(){const{data:i,error:r}=yield t.supabase_client.from(e).select();return i?(console.log(i),i):(console.log(r),r)})()}getTop5GoodNews(e){var t=this;return(0,d.Z)(function*(){const{data:i,error:r}=yield t.supabase_client.from(e).select();return i?i.sort((c,u)=>u.polarity-c.polarity).slice(0,5):(console.log(r),r)})()}getTop5BadNews(e){var t=this;return(0,d.Z)(function*(){const{data:i,error:r}=yield t.supabase_client.from(e).select();return i?i.sort((c,u)=>c.polarity-u.polarity).slice(0,5):(console.log(r),r)})()}static#e=this.\u0275fac=function(t){return new(t||o)};static#t=this.\u0275prov=ei.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},6397:(fe,q,E)=>{E.r(q),E.d(q,{Headers:()=>N,Request:()=>D,Response:()=>O,default:()=>J,fetch:()=>P});var I=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}();const P=I.fetch,J=I.fetch.bind(I),N=I.Headers,D=I.Request,O=I.Response},4968:(fe,q,E)=>{E.d(q,{R:()=>j});var d=E(8421),I=E(9751),P=E(5577),J=E(1144),N=E(576),D=E(3268);const O=["addListener","removeListener"],F=["addEventListener","removeEventListener"],w=["on","off"];function j(K,ie,se,ve){if((0,N.m)(se)&&(ve=se,se=void 0),ve)return j(K,ie,se).pipe((0,D.Z)(ve));const[Ee,Se]=function H(K){return(0,N.m)(K.addEventListener)&&(0,N.m)(K.removeEventListener)}(K)?F.map(de=>L=>K[de](ie,L,se)):function R(K){return(0,N.m)(K.addListener)&&(0,N.m)(K.removeListener)}(K)?O.map(B(K,ie)):function G(K){return(0,N.m)(K.on)&&(0,N.m)(K.off)}(K)?w.map(B(K,ie)):[];if(!Ee&&(0,J.z)(K))return(0,P.z)(de=>j(de,ie,se))((0,d.Xf)(K));if(!Ee)throw new TypeError("Invalid event target");return new I.y(de=>{const L=(...Y)=>de.next(1<Y.length?Y:Y[0]);return Ee(L),()=>Se(L)})}function B(K,ie){return se=>ve=>K[se](ie,ve)}},8372:(fe,q,E)=>{E.d(q,{b:()=>J});var d=E(4986),I=E(4482),P=E(5403);function J(N,D=d.z){return(0,I.e)((O,F)=>{let w=null,j=null,B=null;const R=()=>{if(w){w.unsubscribe(),w=null;const H=j;j=null,F.next(H)}};function G(){const H=B+N,K=D.now();if(K<H)return w=this.schedule(void 0,H-K),void F.add(w);R()}O.subscribe((0,P.x)(F,H=>{j=H,B=D.now(),w||(w=D.schedule(G,N),F.add(w))},()=>{R(),F.complete()},void 0,()=>{j=w=null}))})}},2722:(fe,q,E)=>{E.d(q,{R:()=>N});var d=E(4482),I=E(5403),P=E(8421),J=E(5032);function N(D){return(0,d.e)((O,F)=>{(0,P.Xf)(D).subscribe((0,I.x)(F,()=>F.complete(),J.Z)),!F.closed&&O.subscribe(F)})}},4408:(fe,q,E)=>{E.d(q,{o:()=>N});var d=E(727);class I extends d.w0{constructor(O,F){super()}schedule(O,F=0){return this}}const P={setInterval(D,O,...F){const{delegate:w}=P;return w?.setInterval?w.setInterval(D,O,...F):setInterval(D,O,...F)},clearInterval(D){const{delegate:O}=P;return(O?.clearInterval||clearInterval)(D)},delegate:void 0};var J=E(8737);class N extends I{constructor(O,F){super(O,F),this.scheduler=O,this.work=F,this.pending=!1}schedule(O,F=0){var w;if(this.closed)return this;this.state=O;const j=this.id,B=this.scheduler;return null!=j&&(this.id=this.recycleAsyncId(B,j,F)),this.pending=!0,this.delay=F,this.id=null!==(w=this.id)&&void 0!==w?w:this.requestAsyncId(B,this.id,F),this}requestAsyncId(O,F,w=0){return P.setInterval(O.flush.bind(O,this),w)}recycleAsyncId(O,F,w=0){if(null!=w&&this.delay===w&&!1===this.pending)return F;null!=F&&P.clearInterval(F)}execute(O,F){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const w=this._execute(O,F);if(w)return w;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(O,F){let j,w=!1;try{this.work(O)}catch(B){w=!0,j=B||new Error("Scheduled action threw falsy error")}if(w)return this.unsubscribe(),j}unsubscribe(){if(!this.closed){const{id:O,scheduler:F}=this,{actions:w}=F;this.work=this.state=this.scheduler=null,this.pending=!1,(0,J.P)(w,this),null!=O&&(this.id=this.recycleAsyncId(F,O,null)),this.delay=null,super.unsubscribe()}}}},640:(fe,q,E)=>{E.d(q,{v:()=>P});const d={now:()=>(d.delegate||Date).now(),delegate:void 0};class I{constructor(N,D=I.now){this.schedulerActionCtor=N,this.now=D}schedule(N,D=0,O){return new this.schedulerActionCtor(this,N).schedule(O,D)}}I.now=d.now;class P extends I{constructor(N,D=I.now){super(N,D),this.actions=[],this._active=!1}flush(N){const{actions:D}=this;if(this._active)return void D.push(N);let O;this._active=!0;do{if(O=N.execute(N.state,N.delay))break}while(N=D.shift());if(this._active=!1,O){for(;N=D.shift();)N.unsubscribe();throw O}}}},4986:(fe,q,E)=>{E.d(q,{P:()=>J,z:()=>P});var d=E(4408);const P=new(E(640).v)(d.o),J=P},6547:(fe,q,E)=>{E.d(q,{tE:()=>Ht,qm:()=>oi,X6:()=>a,yG:()=>c});var d=E(6895),I=E(8274),P=E(3353),J=E(1135),N=E(7579),D=E(9646),ft=E(9300);function Je(g){return(0,ft.h)((f,l)=>g<=l)}var un=E(4671),Bn=E(4482),dn=E(5403);function hn(g,f){return g===f}var _t=E(2722),Me=E(1281),fn=E(9841),W=E(7272),pt=E(9751),_n=E(5698),mt=E(8372),be=E(4004),$t=E(8675);const Bt=new Set;let Le,pn=(()=>{class g{constructor(l){this._platform=l,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):gn}matchMedia(l){return(this._platform.WEBKIT||this._platform.BLINK)&&function mn(g){if(!Bt.has(g))try{Le||(Le=document.createElement("style"),Le.setAttribute("type","text/css"),document.head.appendChild(Le)),Le.sheet&&(Le.sheet.insertRule(`@media ${g} {body{ }}`,0),Bt.add(g))}catch(f){console.error(f)}}(l),this._matchMedia(l)}}return g.\u0275fac=function(l){return new(l||g)(I.LFG(P.t4))},g.\u0275prov=I.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();function gn(g){return{matches:"all"===g||""===g,media:g,addListener:()=>{},removeListener:()=>{}}}let vn=(()=>{class g{constructor(l,m){this._mediaMatcher=l,this._zone=m,this._queries=new Map,this._destroySubject=new N.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(l){return gt((0,Me.Eq)(l)).some(y=>this._registerQuery(y).mql.matches)}observe(l){const y=gt((0,Me.Eq)(l)).map($=>this._registerQuery($).observable);let k=(0,fn.a)(y);return k=(0,W.z)(k.pipe((0,_n.q)(1)),k.pipe(Je(1),(0,mt.b)(0))),k.pipe((0,be.U)($=>{const ee={matches:!1,breakpoints:{}};return $.forEach(({matches:Pe,query:Ke})=>{ee.matches=ee.matches||Pe,ee.breakpoints[Ke]=Pe}),ee}))}_registerQuery(l){if(this._queries.has(l))return this._queries.get(l);const m=this._mediaMatcher.matchMedia(l),k={observable:new pt.y($=>{const ee=Pe=>this._zone.run(()=>$.next(Pe));return m.addListener(ee),()=>{m.removeListener(ee)}}).pipe((0,$t.O)(m),(0,be.U)(({matches:$})=>({query:l,matches:$})),(0,_t.R)(this._destroySubject)),mql:m};return this._queries.set(l,k),k}}return g.\u0275fac=function(l){return new(l||g)(I.LFG(pn),I.LFG(I.R0b))},g.\u0275prov=I.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();function gt(g){return g.map(f=>f.split(",")).reduce((f,l)=>f.concat(l)).map(f=>f.trim())}function a(g){return 0===g.buttons||0===g.offsetX&&0===g.offsetY}function c(g){const f=g.touches&&g.touches[0]||g.changedTouches&&g.changedTouches[0];return!(!f||-1!==f.identifier||null!=f.radiusX&&1!==f.radiusX||null!=f.radiusY&&1!==f.radiusY)}const u=new I.OlP("cdk-input-modality-detector-options"),h={ignoreKeys:[18,17,224,91,16]},M=(0,P.i$)({passive:!0,capture:!0});let x=(()=>{class g{get mostRecentModality(){return this._modality.value}constructor(l,m,y,k){this._platform=l,this._mostRecentTarget=null,this._modality=new J.X(null),this._lastTouchMs=0,this._onKeydown=$=>{this._options?.ignoreKeys?.some(ee=>ee===$.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=(0,P.sA)($))},this._onMousedown=$=>{Date.now()-this._lastTouchMs<650||(this._modality.next(a($)?"keyboard":"mouse"),this._mostRecentTarget=(0,P.sA)($))},this._onTouchstart=$=>{c($)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=(0,P.sA)($))},this._options={...h,...k},this.modalityDetected=this._modality.pipe(Je(1)),this.modalityChanged=this.modalityDetected.pipe(function Re(g,f=un.y){return g=g??hn,(0,Bn.e)((l,m)=>{let y,k=!0;l.subscribe((0,dn.x)(m,$=>{const ee=f($);(k||!g(y,ee))&&(k=!1,y=ee,m.next($))}))})}()),l.isBrowser&&m.runOutsideAngular(()=>{y.addEventListener("keydown",this._onKeydown,M),y.addEventListener("mousedown",this._onMousedown,M),y.addEventListener("touchstart",this._onTouchstart,M)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,M),document.removeEventListener("mousedown",this._onMousedown,M),document.removeEventListener("touchstart",this._onTouchstart,M))}}return g.\u0275fac=function(l){return new(l||g)(I.LFG(P.t4),I.LFG(I.R0b),I.LFG(d.K0),I.LFG(u,8))},g.\u0275prov=I.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();const ce=new I.OlP("cdk-focus-monitor-default-options"),me=(0,P.i$)({passive:!0,capture:!0});let Ht=(()=>{class g{constructor(l,m,y,k,$){this._ngZone=l,this._platform=m,this._inputModalityDetector=y,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new N.x,this._rootNodeFocusAndBlurListener=ee=>{for(let Ke=(0,P.sA)(ee);Ke;Ke=Ke.parentElement)"focus"===ee.type?this._onFocus(ee,Ke):this._onBlur(ee,Ke)},this._document=k,this._detectionMode=$?.detectionMode||0}monitor(l,m=!1){const y=(0,Me.fI)(l);if(!this._platform.isBrowser||1!==y.nodeType)return(0,D.of)(null);const k=(0,P.kV)(y)||this._getDocument(),$=this._elementInfo.get(y);if($)return m&&($.checkChildren=!0),$.subject;const ee={checkChildren:m,subject:new N.x,rootNode:k};return this._elementInfo.set(y,ee),this._registerGlobalListeners(ee),ee.subject}stopMonitoring(l){const m=(0,Me.fI)(l),y=this._elementInfo.get(m);y&&(y.subject.complete(),this._setClasses(m),this._elementInfo.delete(m),this._removeGlobalListeners(y))}focusVia(l,m,y){const k=(0,Me.fI)(l);k===this._getDocument().activeElement?this._getClosestElementsInfo(k).forEach(([ee,Pe])=>this._originChanged(ee,m,Pe)):(this._setOrigin(m),"function"==typeof k.focus&&k.focus(y))}ngOnDestroy(){this._elementInfo.forEach((l,m)=>this.stopMonitoring(m))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(l){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(l)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:l&&this._isLastInteractionFromInputLabel(l)?"mouse":"program"}_shouldBeAttributedToTouch(l){return 1===this._detectionMode||!!l?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(l,m){l.classList.toggle("cdk-focused",!!m),l.classList.toggle("cdk-touch-focused","touch"===m),l.classList.toggle("cdk-keyboard-focused","keyboard"===m),l.classList.toggle("cdk-mouse-focused","mouse"===m),l.classList.toggle("cdk-program-focused","program"===m)}_setOrigin(l,m=!1){this._ngZone.runOutsideAngular(()=>{this._origin=l,this._originFromTouchInteraction="touch"===l&&m,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(l,m){const y=this._elementInfo.get(m),k=(0,P.sA)(l);!y||!y.checkChildren&&m!==k||this._originChanged(m,this._getFocusOrigin(k),y)}_onBlur(l,m){const y=this._elementInfo.get(m);!y||y.checkChildren&&l.relatedTarget instanceof Node&&m.contains(l.relatedTarget)||(this._setClasses(m),this._emitOrigin(y,null))}_emitOrigin(l,m){l.subject.observers.length&&this._ngZone.run(()=>l.subject.next(m))}_registerGlobalListeners(l){if(!this._platform.isBrowser)return;const m=l.rootNode,y=this._rootNodeFocusListenerCount.get(m)||0;y||this._ngZone.runOutsideAngular(()=>{m.addEventListener("focus",this._rootNodeFocusAndBlurListener,me),m.addEventListener("blur",this._rootNodeFocusAndBlurListener,me)}),this._rootNodeFocusListenerCount.set(m,y+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,_t.R)(this._stopInputModalityDetector)).subscribe(k=>{this._setOrigin(k,!0)}))}_removeGlobalListeners(l){const m=l.rootNode;if(this._rootNodeFocusListenerCount.has(m)){const y=this._rootNodeFocusListenerCount.get(m);y>1?this._rootNodeFocusListenerCount.set(m,y-1):(m.removeEventListener("focus",this._rootNodeFocusAndBlurListener,me),m.removeEventListener("blur",this._rootNodeFocusAndBlurListener,me),this._rootNodeFocusListenerCount.delete(m))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(l,m,y){this._setClasses(l,m),this._emitOrigin(y,m),this._lastFocusOrigin=m}_getClosestElementsInfo(l){const m=[];return this._elementInfo.forEach((y,k)=>{(k===l||y.checkChildren&&k.contains(l))&&m.push([k,y])}),m}_isLastInteractionFromInputLabel(l){const{_mostRecentTarget:m,mostRecentModality:y}=this._inputModalityDetector;if("mouse"!==y||!m||m===l||"INPUT"!==l.nodeName&&"TEXTAREA"!==l.nodeName||l.disabled)return!1;const k=l.labels;if(k)for(let $=0;$<k.length;$++)if(k[$].contains(m))return!0;return!1}}return g.\u0275fac=function(l){return new(l||g)(I.LFG(I.R0b),I.LFG(P.t4),I.LFG(x),I.LFG(d.K0,8),I.LFG(ce,8))},g.\u0275prov=I.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();const ni="cdk-high-contrast-black-on-white",ii="cdk-high-contrast-white-on-black",In="cdk-high-contrast-active";let oi=(()=>{class g{constructor(l,m){this._platform=l,this._document=m,this._breakpointSubscription=(0,I.f3M)(vn).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const l=this._document.createElement("div");l.style.backgroundColor="rgb(1,2,3)",l.style.position="absolute",this._document.body.appendChild(l);const m=this._document.defaultView||window,y=m&&m.getComputedStyle?m.getComputedStyle(l):null,k=(y&&y.backgroundColor||"").replace(/ /g,"");switch(l.remove(),k){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const l=this._document.body.classList;l.remove(In,ni,ii),this._hasCheckedHighContrastMode=!0;const m=this.getHighContrastMode();1===m?l.add(In,ni):2===m&&l.add(In,ii)}}}return g.\u0275fac=function(l){return new(l||g)(I.LFG(P.t4),I.LFG(d.K0))},g.\u0275prov=I.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},445:(fe,q,E)=>{E.d(q,{Is:()=>O,vT:()=>w});var d=E(8274),I=E(6895);const P=new d.OlP("cdk-dir-doc",{providedIn:"root",factory:function J(){return(0,d.f3M)(I.K0)}}),N=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let O=(()=>{class j{constructor(R){this.value="ltr",this.change=new d.vpe,R&&(this.value=function D(j){const B=j?.toLowerCase()||"";return"auto"===B&&typeof navigator<"u"&&navigator?.language?N.test(navigator.language)?"rtl":"ltr":"rtl"===B?"rtl":"ltr"}((R.body?R.body.dir:null)||(R.documentElement?R.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return j.\u0275fac=function(R){return new(R||j)(d.LFG(P,8))},j.\u0275prov=d.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"}),j})(),w=(()=>{class j{}return j.\u0275fac=function(R){return new(R||j)},j.\u0275mod=d.oAB({type:j}),j.\u0275inj=d.cJS({}),j})()},1281:(fe,q,E)=>{E.d(q,{Eq:()=>N,Ig:()=>I,fI:()=>O});var d=E(8274);function I(w){return null!=w&&"false"!=`${w}`}function N(w){return Array.isArray(w)?w:[w]}function O(w){return w instanceof d.SBq?w.nativeElement:w}},3353:(fe,q,E)=>{E.d(q,{Mq:()=>H,Oy:()=>de,_i:()=>K,i$:()=>B,kV:()=>ve,sA:()=>Se,t4:()=>J});var d=E(8274),I=E(6895);let P;try{P=typeof Intl<"u"&&Intl.v8BreakIterator}catch{P=!1}let w,R,G,ie,J=(()=>{class L{constructor(te){this._platformId=te,this.isBrowser=this._platformId?(0,I.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!P)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return L.\u0275fac=function(te){return new(te||L)(d.LFG(d.Lbi))},L.\u0275prov=d.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();function B(L){return function j(){if(null==w&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>w=!0}))}finally{w=w||!1}return w}()?L:!!L.capture}function H(){if(null==G){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return G=!1,G;if("scrollBehavior"in document.documentElement.style)G=!0;else{const L=Element.prototype.scrollTo;G=!!L&&!/\{\s*\[native code\]\s*\}/.test(L.toString())}}return G}function K(){if("object"!=typeof document||!document)return 0;if(null==R){const L=document.createElement("div"),Y=L.style;L.dir="rtl",Y.width="1px",Y.overflow="auto",Y.visibility="hidden",Y.pointerEvents="none",Y.position="absolute";const te=document.createElement("div"),oe=te.style;oe.width="2px",oe.height="1px",L.appendChild(te),document.body.appendChild(L),R=0,0===L.scrollLeft&&(L.scrollLeft=1,R=0===L.scrollLeft?1:2),L.remove()}return R}function ve(L){if(function se(){if(null==ie){const L=typeof document<"u"?document.head:null;ie=!(!L||!L.createShadowRoot&&!L.attachShadow)}return ie}()){const Y=L.getRootNode?L.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&Y instanceof ShadowRoot)return Y}return null}function Se(L){return L.composedPath?L.composedPath()[0]:L.target}function de(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}},3238:(fe,q,E)=>{E.d(q,{BQ:()=>de,wG:()=>Mt,si:()=>we,pj:()=>Ne,Kr:()=>ge,Id:()=>oe});var d=E(8274),I=E(6547),P=E(445),N=E(6895),D=E(3353),O=E(1281);const Se=new d.OlP("mat-sanity-checks",{providedIn:"root",factory:function Ee(){return!0}});let de=(()=>{class T{constructor(_,b,C){this._sanityChecks=b,this._document=C,this._hasDoneGlobalChecks=!1,_._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(_){return!(0,D.Oy)()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[_])}}return T.\u0275fac=function(_){return new(_||T)(d.LFG(I.qm),d.LFG(Se,8),d.LFG(N.K0))},T.\u0275mod=d.oAB({type:T}),T.\u0275inj=d.cJS({imports:[P.vT,P.vT]}),T})();function oe(T){return class extends T{get disabled(){return this._disabled}set disabled(p){this._disabled=(0,O.Ig)(p)}constructor(...p){super(...p),this._disabled=!1}}}function Ne(T,p){return class extends T{get color(){return this._color}set color(_){const b=_||this.defaultColor;b!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),b&&this._elementRef.nativeElement.classList.add(`mat-${b}`),this._color=b)}constructor(..._){super(..._),this.defaultColor=p,this.color=p}}}function ge(T){return class extends T{get disableRipple(){return this._disableRipple}set disableRipple(p){this._disableRipple=(0,O.Ig)(p)}constructor(...p){super(...p),this._disableRipple=!1}}}class Ve{constructor(p,_,b,C=!1){this._renderer=p,this.element=_,this.config=b,this._animationForciblyDisabledThroughCss=C,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const et=(0,D.i$)({passive:!0,capture:!0});class Tt{constructor(){this._events=new Map,this._delegateEventHandler=p=>{const _=(0,D.sA)(p);_&&this._events.get(p.type)?.forEach((b,C)=>{(C===_||C.contains(_))&&b.forEach(X=>X.handleEvent(p))})}}addHandler(p,_,b,C){const X=this._events.get(_);if(X){const ae=X.get(b);ae?ae.add(C):X.set(b,new Set([C]))}else this._events.set(_,new Map([[b,new Set([C])]])),p.runOutsideAngular(()=>{document.addEventListener(_,this._delegateEventHandler,et)})}removeHandler(p,_,b){const C=this._events.get(p);if(!C)return;const X=C.get(_);X&&(X.delete(b),0===X.size&&C.delete(_),0===C.size&&(this._events.delete(p),document.removeEventListener(p,this._delegateEventHandler,et)))}}const tt={enterDuration:225,exitDuration:150},je=(0,D.i$)({passive:!0,capture:!0}),re=["mousedown","touchstart"],nt=["mouseup","mouseleave","touchend","touchcancel"];class Te{constructor(p,_,b,C){this._target=p,this._ngZone=_,this._platform=C,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,C.isBrowser&&(this._containerElement=(0,O.fI)(b))}fadeInRipple(p,_,b={}){const C=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),X={...tt,...b.animation};b.centered&&(p=C.left+C.width/2,_=C.top+C.height/2);const ae=b.radius||function At(T,p,_){const b=Math.max(Math.abs(T-_.left),Math.abs(T-_.right)),C=Math.max(Math.abs(p-_.top),Math.abs(p-_.bottom));return Math.sqrt(b*b+C*C)}(p,_,C),Ot=p-C.left,Ct=_-C.top,He=X.enterDuration,le=document.createElement("div");le.classList.add("mat-ripple-element"),le.style.left=Ot-ae+"px",le.style.top=Ct-ae+"px",le.style.height=2*ae+"px",le.style.width=2*ae+"px",null!=b.color&&(le.style.backgroundColor=b.color),le.style.transitionDuration=`${He}ms`,this._containerElement.appendChild(le);const ot=window.getComputedStyle(le),Dt=ot.transitionDuration,We="none"===ot.transitionProperty||"0s"===Dt||"0s, 0s"===Dt||0===C.width&&0===C.height,Ae=new Ve(this,le,b,We);le.style.transform="scale3d(1, 1, 1)",Ae.state=0,b.persistent||(this._mostRecentTransientRipple=Ae);let at=null;return!We&&(He||X.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const ct=()=>this._finishRippleTransition(Ae),lt=()=>this._destroyRipple(Ae);le.addEventListener("transitionend",ct),le.addEventListener("transitioncancel",lt),at={onTransitionEnd:ct,onTransitionCancel:lt}}),this._activeRipples.set(Ae,at),(We||!He)&&this._finishRippleTransition(Ae),Ae}fadeOutRipple(p){if(2===p.state||3===p.state)return;const _=p.element,b={...tt,...p.config.animation};_.style.transitionDuration=`${b.exitDuration}ms`,_.style.opacity="0",p.state=2,(p._animationForciblyDisabledThroughCss||!b.exitDuration)&&this._finishRippleTransition(p)}fadeOutAll(){this._getActiveRipples().forEach(p=>p.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(p=>{p.config.persistent||p.fadeOut()})}setupTriggerEvents(p){const _=(0,O.fI)(p);!this._platform.isBrowser||!_||_===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=_,re.forEach(b=>{Te._eventManager.addHandler(this._ngZone,b,_,this)}))}handleEvent(p){"mousedown"===p.type?this._onMousedown(p):"touchstart"===p.type?this._onTouchStart(p):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{nt.forEach(_=>{this._triggerElement.addEventListener(_,this,je)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(p){0===p.state?this._startFadeOutTransition(p):2===p.state&&this._destroyRipple(p)}_startFadeOutTransition(p){const _=p===this._mostRecentTransientRipple,{persistent:b}=p.config;p.state=1,!b&&(!_||!this._isPointerDown)&&p.fadeOut()}_destroyRipple(p){const _=this._activeRipples.get(p)??null;this._activeRipples.delete(p),this._activeRipples.size||(this._containerRect=null),p===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),p.state=3,null!==_&&(p.element.removeEventListener("transitionend",_.onTransitionEnd),p.element.removeEventListener("transitioncancel",_.onTransitionCancel)),p.element.remove()}_onMousedown(p){const _=(0,I.X6)(p),b=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!_&&!b&&(this._isPointerDown=!0,this.fadeInRipple(p.clientX,p.clientY,this._target.rippleConfig))}_onTouchStart(p){if(!this._target.rippleDisabled&&!(0,I.yG)(p)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const _=p.changedTouches;for(let b=0;b<_.length;b++)this.fadeInRipple(_[b].clientX,_[b].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(p=>{!p.config.persistent&&(1===p.state||p.config.terminateOnPointerUp&&0===p.state)&&p.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const p=this._triggerElement;p&&(re.forEach(_=>Te._eventManager.removeHandler(_,p,this)),this._pointerUpEventsRegistered&&nt.forEach(_=>p.removeEventListener(_,this,je)))}}Te._eventManager=new Tt;const it=new d.OlP("mat-ripple-global-options");let Mt=(()=>{class T{get disabled(){return this._disabled}set disabled(_){_&&this.fadeOutAllNonPersistent(),this._disabled=_,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(_){this._trigger=_,this._setupTriggerEventsIfEnabled()}constructor(_,b,C,X,ae){this._elementRef=_,this._animationMode=ae,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=X||{},this._rippleRenderer=new Te(this,b,_,C)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(_,b=0,C){return"number"==typeof _?this._rippleRenderer.fadeInRipple(_,b,{...this.rippleConfig,...C}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,..._})}}return T.\u0275fac=function(_){return new(_||T)(d.Y36(d.SBq),d.Y36(d.R0b),d.Y36(D.t4),d.Y36(it,8),d.Y36(d.QbO,8))},T.\u0275dir=d.lG2({type:T,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(_,b){2&_&&d.ekj("mat-ripple-unbounded",b.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),T})(),we=(()=>{class T{}return T.\u0275fac=function(_){return new(_||T)},T.\u0275mod=d.oAB({type:T}),T.\u0275inj=d.cJS({imports:[de,de]}),T})()},3683:(fe,q,E)=>{E.d(q,{Ye:()=>w,g0:()=>B});var d=E(8274),I=E(3238),P=E(3353),J=E(6895);const N=["*",[["mat-toolbar-row"]]],D=["*","mat-toolbar-row"],O=(0,I.pj)(class{constructor(R){this._elementRef=R}});let F=(()=>{class R{}return R.\u0275fac=function(H){return new(H||R)},R.\u0275dir=d.lG2({type:R,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),R})(),w=(()=>{class R extends O{constructor(H,K,ie){super(H),this._platform=K,this._document=ie}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return R.\u0275fac=function(H){return new(H||R)(d.Y36(d.SBq),d.Y36(P.t4),d.Y36(J.K0))},R.\u0275cmp=d.Xpm({type:R,selectors:[["mat-toolbar"]],contentQueries:function(H,K,ie){if(1&H&&d.Suo(ie,F,5),2&H){let se;d.iGM(se=d.CRH())&&(K._toolbarRows=se)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(H,K){2&H&&d.ekj("mat-toolbar-multiple-rows",K._toolbarRows.length>0)("mat-toolbar-single-row",0===K._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[d.qOj],ngContentSelectors:D,decls:2,vars:0,template:function(H,K){1&H&&(d.F$t(N),d.Hsn(0),d.Hsn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),R})(),B=(()=>{class R{}return R.\u0275fac=function(H){return new(H||R)},R.\u0275mod=d.oAB({type:R}),R.\u0275inj=d.cJS({imports:[I.BQ,I.BQ]}),R})()},5861:(fe,q,E)=>{function d(P,J,N,D,O,F,w){try{var j=P[F](w),B=j.value}catch(R){return void N(R)}j.done?J(B):Promise.resolve(B).then(D,O)}function I(P){return function(){var J=this,N=arguments;return new Promise(function(D,O){var F=P.apply(J,N);function w(B){d(F,D,O,w,j,"next",B)}function j(B){d(F,D,O,w,j,"throw",B)}w(void 0)})}}E.d(q,{Z:()=>I})}}]);